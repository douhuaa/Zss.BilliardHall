# Wolverine é¡¹ç›®æµ‹è¯•å…¥å£è¯´æ˜

## æ¦‚è¿°

æœ¬æ–‡æ¡£è¯´æ˜ Wolverine é¡¹ç›®çš„æµ‹è¯•å…¥å£ä½ç½®å’Œè¿è¡Œæ–¹å¼ã€‚

**âœ¨ é‡è¦å˜æ›´ï¼ˆ2026-01-11ï¼‰**ï¼šé¡¹ç›®ç°é‡‡ç”¨**åˆ†å±‚æµ‹è¯•ç­–ç•¥**ï¼Œé™ä½å¯¹ Aspire AppHost çš„ä¾èµ–ï¼Œæé«˜ CI æµ‹è¯•å¯é æ€§ã€‚

## æµ‹è¯•æ¶æ„ï¼šä¸‰å±‚éªŒè¯ä½“ç³»

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç¬¬ä¸€å±‚ï¼šå•å…ƒæµ‹è¯•ï¼ˆUnit Testsï¼‰                   â”‚
â”‚  - ServiceDefaults é…ç½®æµ‹è¯•                      â”‚
â”‚  - Bootstrapper çƒŸé›¾æµ‹è¯•                         â”‚
â”‚  - æ— éœ€å¤–éƒ¨ä¾èµ–ï¼Œå¿«é€Ÿåé¦ˆ                          â”‚
â”‚  âœ… CI æ¯æ¬¡ PR è¿è¡Œ                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç¬¬äºŒå±‚ï¼šè½»é‡é›†æˆæµ‹è¯•ï¼ˆLightweight Integrationï¼‰   â”‚
â”‚  - Bootstrapper + Testcontainers PostgreSQL     â”‚
â”‚  - Marten æ–‡æ¡£å­˜å‚¨é›†æˆ                           â”‚
â”‚  - ä»…éœ€ Dockerï¼Œæ— éœ€ Aspire DCP                  â”‚
â”‚  â¸ï¸ æœ¬åœ°å¼€å‘æ‰‹åŠ¨è¿è¡Œ                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç¬¬ä¸‰å±‚ï¼šç«¯åˆ°ç«¯æµ‹è¯•ï¼ˆE2E Testsï¼‰                  â”‚
â”‚  - AppHost + Aspire DCP + å®Œæ•´ç¼–æ’               â”‚
â”‚  - å¤šæœåŠ¡ååŒéªŒè¯                                 â”‚
â”‚  âŒ ä»…åœ¨æ‰‹åŠ¨è§¦å‘æˆ– push main æ—¶è¿è¡Œ               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æµ‹è¯•é¡¹ç›®ä½ç½®

å½“å‰ Wolverine é¡¹ç›®åŒ…å« **3 ä¸ªæµ‹è¯•é¡¹ç›®**ï¼š

### 1. Zss.BilliardHall.Wolverine.ServiceDefaults.Tests âš¡ ç¬¬ä¸€å±‚

**è·¯å¾„**: `src/Wolverine/Aspire/Zss.BilliardHall.Wolverine.ServiceDefaults.Tests/`

**é¡¹ç›®æ–‡ä»¶**: `Zss.BilliardHall.Wolverine.ServiceDefaults.Tests.csproj`

**æµ‹è¯•æ¡†æ¶**: xUnit

**æµ‹è¯•å†…å®¹**: 
- ServiceDefaults æ‰©å±•æ–¹æ³•é›†æˆæµ‹è¯•
- Marten é…ç½®æµ‹è¯•
- OpenTelemetry é…ç½®æµ‹è¯•
- HealthChecks é…ç½®æµ‹è¯•
- Wolverine é»˜è®¤é…ç½®æµ‹è¯•

**åŒ…å«çš„æµ‹è¯•æ–‡ä»¶**:
1. `MartenExtensionsTests.cs` - Marten æ‰©å±•æ–¹æ³•æµ‹è¯•ï¼ˆ7ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼‰
2. `ServiceDefaultsIntegrationTests.cs` - ServiceDefaults é›†æˆæµ‹è¯•ï¼ˆ12ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼‰

**æµ‹è¯•æ•°é‡**ï¼š19 ä¸ª

**ç‰¹ç‚¹**ï¼š
- âœ… æ— éœ€å¤–éƒ¨ä¾èµ–
- âœ… å¿«é€Ÿæ‰§è¡Œï¼ˆ< 5 ç§’ï¼‰
- âœ… CI æ¯æ¬¡ PR è¿è¡Œ

### 2. Zss.BilliardHall.Wolverine.Bootstrapper.Tests ğŸš€ ç¬¬äºŒå±‚ï¼ˆæ–°å¢ï¼‰

**è·¯å¾„**: `src/Wolverine/Bootstrapper.Tests/`

**é¡¹ç›®æ–‡ä»¶**: `Zss.BilliardHall.Wolverine.Bootstrapper.Tests.csproj`

**æµ‹è¯•æ¡†æ¶**: xUnit + Testcontainers

**æµ‹è¯•å†…å®¹**:
- **çƒŸé›¾æµ‹è¯•ï¼ˆSmoke Testsï¼‰**ï¼šéªŒè¯ Bootstrapper é…ç½®å®Œæ•´æ€§
- **é›†æˆæµ‹è¯•ï¼ˆIntegration Testsï¼‰**ï¼šä½¿ç”¨çœŸå® PostgreSQL å®¹å™¨éªŒè¯ Marten + Wolverine

**åŒ…å«çš„æµ‹è¯•æ–‡ä»¶**:
1. `BootstrapperSmokeTests.cs` - çƒŸé›¾æµ‹è¯•ï¼ˆ6ä¸ªï¼Œ`Category=Unit`ï¼‰
2. `BootstrapperIntegrationTests.cs` - é›†æˆæµ‹è¯•ï¼ˆ5ä¸ªï¼Œ`Category=Integration+RequiresDocker`ï¼‰
3. `PostgresFixture.cs` - PostgreSQL æµ‹è¯•å®¹å™¨ç®¡ç†

**æµ‹è¯•æ•°é‡**ï¼š11 ä¸ª
- çƒŸé›¾æµ‹è¯•ï¼ˆUnitï¼‰ï¼š6 ä¸ª
- é›†æˆæµ‹è¯•ï¼ˆIntegrationï¼‰ï¼š5 ä¸ª

**ç‰¹ç‚¹**ï¼š
- âœ… çƒŸé›¾æµ‹è¯•æ— éœ€ Dockerï¼ŒCI æ¯æ¬¡ PR è¿è¡Œ
- ğŸ³ é›†æˆæµ‹è¯•éœ€è¦ Dockerï¼ˆæœ¬åœ°æ‰‹åŠ¨è¿è¡Œï¼‰
- ğŸš€ ä½¿ç”¨ Testcontainersï¼Œæ— éœ€ Aspire DCP
- ğŸ”„ è‡ªåŠ¨ç®¡ç†å®¹å™¨ç”Ÿå‘½å‘¨æœŸ

**è¯¦ç»†æ–‡æ¡£**: [Bootstrapper.Tests README](Bootstrapper.Tests/README.md)

### 3. Zss.BilliardHall.Wolverine.AppHost.Tests ğŸ—ï¸ ç¬¬ä¸‰å±‚

**è·¯å¾„**: `src/Wolverine/Aspire/Zss.BilliardHall.Wolverine.AppHost.Tests/`

**é¡¹ç›®æ–‡ä»¶**: `Zss.BilliardHall.Wolverine.AppHost.Tests.csproj`

**æµ‹è¯•æ¡†æ¶**: xUnit + Aspire.Hosting.Testing

**æµ‹è¯•å†…å®¹**:
- AppHost ç¼–æ’éªŒè¯
- å¤šæœåŠ¡ååŒæµ‹è¯•
- å®Œæ•´ç«¯åˆ°ç«¯éªŒè¯

**åŒ…å«çš„æµ‹è¯•æ–‡ä»¶**:
1. `AppHostIntegrationTests.cs` - AppHost é›†æˆæµ‹è¯•ï¼ˆ3ä¸ªæµ‹è¯•ï¼Œé»˜è®¤ Skipï¼‰

**æµ‹è¯•æ•°é‡**ï¼š3 ä¸ªï¼ˆé»˜è®¤è¢«è·³è¿‡ï¼‰

**ç‰¹ç‚¹**ï¼š
- âš ï¸ éœ€è¦ Docker + Aspire DCP
- â±ï¸ å¯åŠ¨æ…¢ï¼ˆå®¹å™¨ç¼–æ’ï¼‰
- âŒ CI ä¸­ä¸è‡ªåŠ¨è¿è¡Œï¼ˆä»…æ‰‹åŠ¨è§¦å‘æˆ– push mainï¼‰
- ğŸ”’ é»˜è®¤ Skipï¼Œéœ€æ‰‹åŠ¨å¯ç”¨

**è¯¦ç»†æ–‡æ¡£**: [AppHost.Tests README](Aspire/Zss.BilliardHall.Wolverine.AppHost.Tests/README.md)

## æµ‹è¯•ç”¨ä¾‹åˆ—è¡¨

### MartenExtensionsTests (7ä¸ªæµ‹è¯•)
1. `AddMartenDefaults_WithValidConnectionString_ShouldRegisterMartenServices` - éªŒè¯ä½¿ç”¨æœ‰æ•ˆè¿æ¥å­—ç¬¦ä¸²æ³¨å†Œ Marten æœåŠ¡
2. `AddMartenDefaults_WithMissingConnectionString_ShouldThrowInvalidOperationException` - éªŒè¯ç¼ºå°‘è¿æ¥å­—ç¬¦ä¸²æ—¶æŠ›å‡ºå¼‚å¸¸
3. `AddMartenDefaults_ShouldConfigureSchemaName` - éªŒè¯é…ç½® Schema åç§°ä¸º "billiard"
4. `AddMartenDefaults_ShouldUseProvidedConnectionString` - éªŒè¯ä½¿ç”¨æä¾›çš„è¿æ¥å­—ç¬¦ä¸²
5. `AddMartenDefaults_WithValidConfiguration_ShouldSucceed` - éªŒè¯æœ‰æ•ˆé…ç½®æˆåŠŸ
6. `AddMartenDefaults_WithEmptyConnectionString_ShouldThrowInvalidOperationException` - éªŒè¯ç©ºè¿æ¥å­—ç¬¦ä¸²æ—¶æŠ›å‡ºå¼‚å¸¸
7. `AddMartenDefaults_ShouldConfigureLightweightSessions` - éªŒè¯é…ç½®è½»é‡çº§ä¼šè¯

### ServiceDefaultsIntegrationTests (12ä¸ªæµ‹è¯•)
1. `AddServiceDefaults_ShouldRegisterAllRequiredServices` - éªŒè¯æ³¨å†Œæ‰€æœ‰å¿…éœ€æœåŠ¡
2. `AddDefaultHealthChecks_ShouldRegisterSelfCheck` - éªŒè¯æ³¨å†Œ "self" å¥åº·æ£€æŸ¥
3. `AddDefaultHealthChecks_SelfCheck_ShouldReturnHealthy` - éªŒè¯ "self" æ£€æŸ¥è¿”å›å¥åº·çŠ¶æ€
4. `ConfigureOpenTelemetry_ShouldRegisterTracingAndMetrics` - éªŒè¯é…ç½® OpenTelemetry è¿½è¸ªå’ŒæŒ‡æ ‡
5. `MapDefaultEndpoints_InDevelopment_ShouldMapHealthCheckEndpoints` - éªŒè¯å¼€å‘ç¯å¢ƒæ˜ å°„å¥åº·æ£€æŸ¥ç«¯ç‚¹
6. `MapDefaultEndpoints_InProduction_ShouldNotMapHealthCheckEndpoints` - éªŒè¯ç”Ÿäº§ç¯å¢ƒä¸æ˜ å°„å¥åº·æ£€æŸ¥ç«¯ç‚¹
7. `AddServiceDefaults_ShouldConfigureHttpClientWithResilience` - éªŒè¯é…ç½® HttpClient å¼¹æ€§
8. `AddServiceDefaults_ShouldBeIdempotent` - éªŒè¯ AddServiceDefaults å¹‚ç­‰æ€§
9. `AddWolverineDefaults_ShouldRegisterWolverineServices` - éªŒè¯æ³¨å†Œ Wolverine æœåŠ¡
10. `AddWolverineDefaults_ShouldEnableFluentValidation` - éªŒè¯å¯ç”¨ FluentValidation
11. `AddWolverineDefaults_WithServiceDefaults_ShouldWorkTogether` - éªŒè¯ ServiceDefaults å’Œ WolverineDefaults ååŒå·¥ä½œ
12. `AddWolverineDefaults_CalledMultipleTimes_ShouldThrow` - éªŒè¯å¤šæ¬¡è°ƒç”¨ AddWolverineDefaults æŠ›å‡ºå¼‚å¸¸

**å…±è®¡: 19 ä¸ªæµ‹è¯•ç”¨ä¾‹**

## å¦‚ä½•è¿è¡Œæµ‹è¯•

### ğŸ¯ æ¨èï¼šä½¿ç”¨ä¾¿æ·è„šæœ¬ï¼ˆæ–°å¢ï¼‰

**å¿«æ·æ–¹å¼**: æˆ‘ä»¬æä¾›äº†ä¾¿æ·çš„ Bash è„šæœ¬æ¥è¿è¡Œä¸åŒå±‚çº§çš„æµ‹è¯•ã€‚

**Quick access**: We provide convenient Bash scripts to run different test layers.

```bash
cd src/Wolverine/scripts

# å¿«é€ŸçƒŸé›¾æµ‹è¯•ï¼ˆæ— éœ€ Dockerï¼Œ< 2 ç§’ï¼‰
./test-smoke.sh

# é›†æˆæµ‹è¯•ï¼ˆéœ€è¦ Dockerï¼Œçº¦ 10 ç§’ï¼‰
./test-integration.sh

# æ‰€æœ‰æµ‹è¯•ï¼ˆçƒŸé›¾ + é›†æˆï¼Œçº¦ 30 ç§’ï¼‰
./test-all.sh

# æ¨¡æ‹Ÿ CI ç¯å¢ƒï¼ˆåŒ…å«æ„å»ºã€æ ¼å¼æ£€æŸ¥ï¼‰
./test-ci.sh
```

ğŸ“– **è¯¦ç»†æ–‡æ¡£**: [scripts/README.md](scripts/README.md)

---

### æ¨èï¼šåˆ†å±‚æµ‹è¯•ç­–ç•¥

#### ğŸš€ å¿«é€ŸéªŒè¯ï¼ˆæ— éœ€ Dockerï¼Œ< 10 ç§’ï¼‰
è¿è¡Œç¬¬ä¸€å±‚æµ‹è¯•ï¼ˆServiceDefaults + Bootstrapper çƒŸé›¾æµ‹è¯•ï¼‰ï¼š

```bash
cd src/Wolverine

# ä½¿ç”¨è„šæœ¬ï¼ˆæ¨èï¼‰
./scripts/test-smoke.sh

# æˆ–æ‰‹åŠ¨è¿è¡Œ
# ServiceDefaults æµ‹è¯•
dotnet test Aspire/Zss.BilliardHall.Wolverine.ServiceDefaults.Tests

# Bootstrapper çƒŸé›¾æµ‹è¯•
dotnet test Bootstrapper.Tests --filter "Category=Unit"
```

#### ğŸ³ å®Œæ•´éªŒè¯ï¼ˆéœ€è¦ Dockerï¼Œçº¦ 30 ç§’ï¼‰
è¿è¡Œç¬¬ä¸€å±‚ + ç¬¬äºŒå±‚æµ‹è¯•ï¼ˆåŒ…å« Testcontainers é›†æˆæµ‹è¯•ï¼‰ï¼š

```bash
cd src/Wolverine

# ä½¿ç”¨è„šæœ¬ï¼ˆæ¨èï¼‰
./scripts/test-all.sh

# æˆ–æ‰‹åŠ¨è¿è¡Œ
# ç¡®ä¿ Docker æ­£åœ¨è¿è¡Œ
docker info

# è¿è¡Œæ‰€æœ‰é AppHost æµ‹è¯•
dotnet test --filter "Category!=RequiresDocker|Category=Unit"

# æˆ–åˆ†åˆ«è¿è¡Œ
dotnet test Aspire/Zss.BilliardHall.Wolverine.ServiceDefaults.Tests
dotnet test Bootstrapper.Tests
```

#### ğŸ—ï¸ ç«¯åˆ°ç«¯éªŒè¯ï¼ˆéœ€è¦ Docker + Aspire DCPï¼Œè¾ƒæ…¢ï¼‰
è¿è¡Œç¬¬ä¸‰å±‚ AppHost æµ‹è¯•ï¼ˆ**æ³¨æ„**ï¼šéœ€è¦æ‰‹åŠ¨ç§»é™¤ `Skip` å±æ€§ï¼‰ï¼š

```bash
cd src/Wolverine

# 1. ç¼–è¾‘ AppHostIntegrationTests.csï¼Œç§»é™¤ Skip å±æ€§
# 2. è¿è¡Œæµ‹è¯•
dotnet test Aspire/Zss.BilliardHall.Wolverine.AppHost.Tests
```

### ä¼ ç»Ÿæ–¹å¼

#### 1. è¿è¡Œæ‰€æœ‰æµ‹è¯•ï¼ˆåŒ…æ‹¬ AppHostï¼Œå¦‚æœå¯ç”¨ï¼‰

```bash
cd src/Wolverine
dotnet test
```

#### 2. åˆ—å‡ºæ‰€æœ‰æµ‹è¯•ï¼ˆä¸è¿è¡Œï¼‰

```bash
cd src/Wolverine
dotnet test --list-tests
```

#### 3. è¿è¡Œç‰¹å®šæµ‹è¯•é¡¹ç›®

```bash
cd src/Wolverine

# ServiceDefaults æµ‹è¯•
dotnet test Aspire/Zss.BilliardHall.Wolverine.ServiceDefaults.Tests/Zss.BilliardHall.Wolverine.ServiceDefaults.Tests.csproj

# Bootstrapper æµ‹è¯•
dotnet test Bootstrapper.Tests/Zss.BilliardHall.Wolverine.Bootstrapper.Tests.csproj

# AppHost æµ‹è¯•
dotnet test Aspire/Zss.BilliardHall.Wolverine.AppHost.Tests/Zss.BilliardHall.Wolverine.AppHost.Tests.csproj
```

#### 4. æŒ‰ç±»åˆ«è¿‡æ»¤

```bash
cd src/Wolverine

# åªè¿è¡Œå•å…ƒæµ‹è¯•
dotnet test --filter "Category=Unit"

# åªè¿è¡Œé›†æˆæµ‹è¯•
dotnet test --filter "Category=Integration"

# æ’é™¤éœ€è¦ Docker çš„æµ‹è¯•
dotnet test --filter "Category!=RequiresDocker"
```

#### 5. è¿è¡Œç‰¹å®šæµ‹è¯•ç±»

```bash
cd src/Wolverine
dotnet test --filter "FullyQualifiedName~MartenExtensionsTests"
dotnet test --filter "FullyQualifiedName~BootstrapperSmokeTests"
```

#### 6. è¿è¡Œç‰¹å®šæµ‹è¯•æ–¹æ³•

```bash
cd src/Wolverine
dotnet test --filter "FullyQualifiedName=Zss.BilliardHall.Wolverine.Bootstrapper.Tests.BootstrapperSmokeTests.BuildApp_WithValidArgs_ShouldSucceed"
```

#### 7. è¿è¡Œæµ‹è¯•å¹¶æ˜¾ç¤ºè¯¦ç»†è¾“å‡º

```bash
cd src/Wolverine
dotnet test --verbosity normal
```

æˆ–è€…æ›´è¯¦ç»†ï¼š

```bash
cd src/Wolverine
dotnet test --verbosity detailed
```

### CI/CD æµ‹è¯•ç­–ç•¥

#### GitHub Actions CI
```yaml
# PR æ£€æŸ¥ï¼šå¿«é€Ÿåé¦ˆï¼ˆæ—  Dockerï¼‰
- ServiceDefaults.Testsï¼ˆ19ä¸ªæµ‹è¯•ï¼‰
- Bootstrapper.Tests --filter "Category=Unit"ï¼ˆ6ä¸ªæµ‹è¯•ï¼‰
æ€»è€—æ—¶ï¼š< 10 ç§’

# æ‰‹åŠ¨è§¦å‘æˆ– push mainï¼šå®Œæ•´éªŒè¯
- ä¸Šè¿°æ‰€æœ‰æµ‹è¯•
- AppHost.Testsï¼ˆå¯é€‰ï¼Œéœ€æ‰‹åŠ¨å¯ç”¨ï¼‰
æ€»è€—æ—¶ï¼šè§† AppHost å¯åŠ¨é€Ÿåº¦è€Œå®š
```

## æµ‹è¯•é¡¹ç›®ä¾èµ–

æµ‹è¯•é¡¹ç›®ä¾èµ–ä»¥ä¸‹ NuGet åŒ…ï¼š

- `Microsoft.NET.Test.Sdk` - .NET æµ‹è¯• SDK
- `xunit` - xUnit æµ‹è¯•æ¡†æ¶
- `xunit.runner.visualstudio` - Visual Studio æµ‹è¯•è¿è¡Œå™¨
- `FluentAssertions` - æµç•…æ–­è¨€åº“
- `Microsoft.AspNetCore.Mvc.Testing` - ASP.NET Core æµ‹è¯•æ”¯æŒ
- `Marten` - Marten æ–‡æ¡£æ•°æ®åº“
- `WolverineFx.Http` - Wolverine HTTP æ”¯æŒ

## é¡¹ç›®å¼•ç”¨

æµ‹è¯•é¡¹ç›®å¼•ç”¨ï¼š

- `Zss.BilliardHall.Wolverine.ServiceDefaults` - è¢«æµ‹è¯•çš„ ServiceDefaults é¡¹ç›®

## æœªæ¥æµ‹è¯•è®¡åˆ’

æ ¹æ® `README.md` ä¸­çš„å¾…åŠäº‹é¡¹ï¼Œæœªæ¥å°†æ·»åŠ ä»¥ä¸‹æµ‹è¯•ï¼š

### é˜¶æ®µä¸€ï¼šBootstrapper é…ç½®æµ‹è¯•
- Wolverine é…ç½®æµ‹è¯•
- Marten æ–‡æ¡£æ•°æ®åº“é…ç½®æµ‹è¯•
- Serilog æ—¥å¿—é…ç½®æµ‹è¯•
- HTTP ç«¯ç‚¹æ‰«ææµ‹è¯•

### é˜¶æ®µäºŒï¼šMembers æ¨¡å—æµ‹è¯•
- RegisterMember åŠŸèƒ½æµ‹è¯•
- GetMember æŸ¥è¯¢æµ‹è¯•
- MemberRegistered äº‹ä»¶æµ‹è¯•

### é˜¶æ®µä¸‰ï¼šå…¶ä»–æ¨¡å—æµ‹è¯•
- Tables æ¨¡å—æµ‹è¯•
- Sessions æ¨¡å—æµ‹è¯•

### é˜¶æ®µå››ï¼šé›†æˆæµ‹è¯•
- åˆ›å»ºé›†æˆæµ‹è¯•é¡¹ç›®
- æ ¸å¿ƒåŠŸèƒ½ç«¯åˆ°ç«¯æµ‹è¯•
- åº”ç”¨å¯åŠ¨éªŒè¯æµ‹è¯•

## æµ‹è¯•æœ€ä½³å®è·µ

å‚è€ƒä»¥ä¸‹å¼€å‘è§„èŒƒï¼š

- [ä»£ç é£æ ¼è§„èŒƒ](../../../doc/06_å¼€å‘è§„èŒƒ/ä»£ç é£æ ¼.md)
- [FluentValidationé›†æˆæŒ‡å—](../../../doc/06_å¼€å‘è§„èŒƒ/FluentValidationé›†æˆæŒ‡å—.md)
- [å•å…ƒæµ‹è¯•è®¡åˆ’](../../../doc/09_æµ‹è¯•æ–¹æ¡ˆ/å•å…ƒæµ‹è¯•è®¡åˆ’.md)
- [é›†æˆæµ‹è¯•è®¡åˆ’](../../../doc/09_æµ‹è¯•æ–¹æ¡ˆ/é›†æˆæµ‹è¯•è®¡åˆ’.md)

### æµ‹è¯•å‘½åè§„èŒƒ

æµ‹è¯•æ–¹æ³•å‘½åéµå¾ªæ¨¡å¼ï¼š`MethodName_Condition_ExpectedResult`

ç¤ºä¾‹ï¼š
- `AddMartenDefaults_WithValidConnectionString_ShouldRegisterMartenServices`
- `AddServiceDefaults_ShouldRegisterAllRequiredServices`

### æµ‹è¯•ç»„ç»‡

- ä½¿ç”¨ **Arrange-Act-Assert** æ¨¡å¼ç»„ç»‡æµ‹è¯•
- æ¯ä¸ªæµ‹è¯•èšç„¦å•ä¸€åŠŸèƒ½ç‚¹
- ä½¿ç”¨ FluentAssertions ç¼–å†™æ¸…æ™°çš„æ–­è¨€
- æ·»åŠ ä¸­è‹±æ–‡æ³¨é‡Šè¯´æ˜æµ‹è¯•æ„å›¾

## æµ‹è¯•ç»Ÿè®¡æ€»è§ˆ

| æµ‹è¯•é¡¹ç›® | æµ‹è¯•æ•°é‡ | æ‰§è¡Œæ—¶é—´ | Docker éœ€æ±‚ | CI è¿è¡Œ |
|---------|---------|---------|------------|---------|
| ServiceDefaults.Tests | 19 | < 5 ç§’ | âŒ æ— éœ€ | âœ… æ¯æ¬¡ PR |
| Bootstrapper.Tests (Unit) | 6 | < 2 ç§’ | âŒ æ— éœ€ | âœ… æ¯æ¬¡ PR |
| Bootstrapper.Tests (Integration) | 5 | 5-10 ç§’ | âœ… éœ€è¦ | â¸ï¸ æœ¬åœ°æ‰‹åŠ¨ |
| AppHost.Tests | 3 | 30+ ç§’ | âœ… éœ€è¦ + DCP | âŒ æ‰‹åŠ¨è§¦å‘ |
| **æ€»è®¡** | **33** | **å˜åŒ–** | - | - |

## æµ‹è¯•æœ€ä½³å®è·µ

å‚è€ƒä»¥ä¸‹å¼€å‘è§„èŒƒï¼š

- [ä»£ç é£æ ¼è§„èŒƒ](../../doc/06_å¼€å‘è§„èŒƒ/ä»£ç é£æ ¼.md)
- [FluentValidationé›†æˆæŒ‡å—](../../doc/06_å¼€å‘è§„èŒƒ/FluentValidationé›†æˆæŒ‡å—.md)
- [å•å…ƒæµ‹è¯•è®¡åˆ’](../../doc/09_æµ‹è¯•æ–¹æ¡ˆ/å•å…ƒæµ‹è¯•è®¡åˆ’.md)
- [é›†æˆæµ‹è¯•è®¡åˆ’](../../doc/09_æµ‹è¯•æ–¹æ¡ˆ/é›†æˆæµ‹è¯•è®¡åˆ’.md)

### æµ‹è¯•å‘½åè§„èŒƒ

æµ‹è¯•æ–¹æ³•å‘½åéµå¾ªæ¨¡å¼ï¼š`MethodName_Condition_ExpectedResult`

ç¤ºä¾‹ï¼š
- `AddMartenDefaults_WithValidConnectionString_ShouldRegisterMartenServices`
- `BuildApp_WithValidArgs_ShouldSucceed`
- `Marten_CanPersistAndRetrieveDocument`

### æµ‹è¯•ç»„ç»‡

- ä½¿ç”¨ **Arrange-Act-Assert** æ¨¡å¼ç»„ç»‡æµ‹è¯•
- æ¯ä¸ªæµ‹è¯•èšç„¦å•ä¸€åŠŸèƒ½ç‚¹
- ä½¿ç”¨ FluentAssertions ç¼–å†™æ¸…æ™°çš„æ–­è¨€
- æ·»åŠ ä¸­è‹±æ–‡æ³¨é‡Šè¯´æ˜æµ‹è¯•æ„å›¾
- ä½¿ç”¨ `[Trait]` æ ‡è®°æµ‹è¯•ç±»åˆ«

## æ¶æ„å˜æ›´è®°å½•

### 2026-01-11: å¼•å…¥åˆ†å±‚æµ‹è¯•æ¶æ„ âœ¨

**é—®é¢˜**ï¼šAppHost é›†æˆæµ‹è¯•ä¾èµ– Docker + Aspire DCPï¼Œåœ¨ CI ç¯å¢ƒä¸­è¶…æ—¶/ä¸ç¨³å®šã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. **æŠ½å– Host æ„å»ºé€»è¾‘** â†’ `BootstrapperHost` é™æ€ç±»
2. **åˆ›å»ºè½»é‡æµ‹è¯•é¡¹ç›®** â†’ `Bootstrapper.Tests` + Testcontainers
3. **åˆ†å±‚æµ‹è¯•ç­–ç•¥**ï¼š
   - ç¬¬ä¸€å±‚ï¼šå•å…ƒæµ‹è¯•ï¼ˆæ— å¤–éƒ¨ä¾èµ–ï¼‰
   - ç¬¬äºŒå±‚ï¼šè½»é‡é›†æˆæµ‹è¯•ï¼ˆä»…éœ€ Dockerï¼‰
   - ç¬¬ä¸‰å±‚ï¼šç«¯åˆ°ç«¯æµ‹è¯•ï¼ˆå®Œæ•´ AppHostï¼‰
4. **CI ä¼˜åŒ–**ï¼šPR åªè¿è¡Œå¿«é€Ÿæµ‹è¯•ï¼ŒAppHost æµ‹è¯•æ”¹ä¸ºå¯é€‰

**æ”¶ç›Š**ï¼š
- âœ… CI æµ‹è¯•æ—¶é—´ä» 30+ ç§’é™è‡³ < 10 ç§’
- âœ… æµ‹è¯•è¦†ç›–ç‡æå‡ï¼ˆæ–°å¢ 11 ä¸ª Bootstrapper æµ‹è¯•ï¼‰
- âœ… é™ä½ CI å¤±è´¥ç‡ï¼ˆç§»é™¤å¯¹ Aspire DCP çš„å¼ºä¾èµ–ï¼‰
- âœ… æœ¬åœ°å¼€å‘ä½“éªŒæ”¹å–„ï¼ˆå¿«é€Ÿåé¦ˆï¼‰

## æŒç»­é›†æˆ

æµ‹è¯•åœ¨ CI/CD æµç¨‹ä¸­è‡ªåŠ¨è¿è¡Œã€‚**å¿…é¡»æ‰€æœ‰ç¬¬ä¸€å±‚æµ‹è¯•é€šè¿‡æ‰èƒ½åˆå¹¶ PR**ã€‚

GitHub Actions Workflow: [.github/workflows/ci.yml](../../.github/workflows/ci.yml)

## ç›¸å…³æ–‡æ¡£

- [Wolverineå¿«é€Ÿä¸Šæ‰‹æŒ‡å—](../../doc/03_ç³»ç»Ÿæ¶æ„è®¾è®¡/Wolverineå¿«é€Ÿä¸Šæ‰‹æŒ‡å—.md)
- [Wolverineæ¨¡å—åŒ–æ¶æ„è“å›¾](../../doc/03_ç³»ç»Ÿæ¶æ„è®¾è®¡/Wolverineæ¨¡å—åŒ–æ¶æ„è“å›¾.md)
- [ServiceDefaultsé›†æˆæŒ‡å—](../../doc/06_å¼€å‘è§„èŒƒ/ServiceDefaultsé›†æˆæŒ‡å—.md)
- [æµ‹è¯•æ–¹æ¡ˆæ–‡æ¡£](../../doc/09_æµ‹è¯•æ–¹æ¡ˆ/)
- [Bootstrapper.Tests README](Bootstrapper.Tests/README.md)
- [AppHost.Tests README](Aspire/Zss.BilliardHall.Wolverine.AppHost.Tests/README.md)

---

**æœ€åæ›´æ–°**: 2026-01-11  
**ç‰ˆæœ¬**: 2.0.0 - åˆ†å±‚æµ‹è¯•æ¶æ„  
**æµ‹è¯•é¡¹ç›®**: 3 ä¸ªï¼ˆServiceDefaults.Tests, Bootstrapper.Tests, AppHost.Testsï¼‰  
**æ€»æµ‹è¯•æ•°**: 33 ä¸ª
