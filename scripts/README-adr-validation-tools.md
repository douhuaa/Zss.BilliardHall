# ADR éªŒè¯å·¥å…·å¥—ä»¶

æœ¬ç›®å½•åŒ…å«ç”¨äºéªŒè¯ ADR ä¸€è‡´æ€§å’Œè´¨é‡çš„è‡ªåŠ¨åŒ–å·¥å…·ã€‚

## å·¥å…·æ¦‚è§ˆ

### 1. ADR ä¸€è‡´æ€§æ£€æŸ¥å™¨ (`check-adr-consistency.sh`)

**ç”¨é€”**ï¼šéªŒè¯ ADR æ–‡æ¡£çš„æ ¼å¼ä¸€è‡´æ€§

**æ£€æŸ¥é¡¹**ï¼š
- âœ… Front Matter å®Œæ•´æ€§ï¼ˆADR-902 è¦æ±‚ï¼‰
- âœ… æœ¯è¯­è¡¨æ ¼å¼ï¼ˆADR-0006 æ ‡å‡†ï¼‰
- âœ… ç‰ˆæœ¬å·æ ¼å¼ï¼ˆADR-980 è¦æ±‚ï¼‰
- âœ… å¿«é€Ÿå‚è€ƒè¡¨ï¼ˆADR-0006 æ¨èï¼‰

**ä½¿ç”¨æ–¹æ³•**ï¼š
```bash
./scripts/check-adr-consistency.sh
```

**è¾“å‡ºç¤ºä¾‹**ï¼š
```
ğŸ” å¼€å§‹ ADR ä¸€è‡´æ€§æ£€æŸ¥...

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
æ£€æŸ¥ 1: Front Matter å®Œæ•´æ€§
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âŒ ADR-0001-modular-monolith-vertical-slice-architecture.md ç¼ºå°‘ Front Matter
...
```

---

### 2. ADR å…³ç³»éªŒè¯å™¨ (`validate-adr-relationships.py`)

**ç”¨é€”**ï¼šéªŒè¯ ADR ä¹‹é—´å…³ç³»å£°æ˜çš„åŒå‘ä¸€è‡´æ€§

**æ£€æŸ¥é¡¹**ï¼š
- âœ… åŒå‘å…³ç³»ä¸€è‡´æ€§ï¼ˆä¾èµ–ã€è¢«ä¾èµ–ã€æ›¿ä»£ç­‰ï¼‰
- âœ… å¾ªç¯ä¾èµ–æ£€æµ‹
- âœ… å­¤ç«‹å…³ç³»å¼•ç”¨ï¼ˆå¼•ç”¨ä¸å­˜åœ¨çš„ ADRï¼‰

**ä½¿ç”¨æ–¹æ³•**ï¼š
```bash
python3 ./scripts/validate-adr-relationships.py
```

**ä¾èµ–**ï¼šPython 3.6+

**è¾“å‡ºç¤ºä¾‹**ï¼š
```
ğŸ” å¼€å§‹ ADR å…³ç³»ä¸€è‡´æ€§éªŒè¯...

æ‰«æ ADR æ–‡ä»¶...
  â€¢ å·²è§£æ ADR-0001
  â€¢ å·²è§£æ ADR-0002
...

âœ… æˆåŠŸè§£æ 46 ä¸ª ADR

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
æ£€æŸ¥ 1: åŒå‘å…³ç³»ä¸€è‡´æ€§
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

å‘ç° 1 ä¸ªå…³ç³»ä¸ä¸€è‡´é—®é¢˜ï¼š
  âŒ ADR-0001 å£°æ˜ä¾èµ– ADR-0002ï¼Œä½† ADR-0002 æœªå£°æ˜è¢« ADR-0001 ä¾èµ–
```

---

### 3. æœ¯è¯­ä¸€è‡´æ€§æ£€æŸ¥å™¨ (`check-terminology.sh`)

**ç”¨é€”**ï¼šéªŒè¯æœ¯è¯­å®šä¹‰çš„ä¸€è‡´æ€§å’Œæ ¼å¼

**æ£€æŸ¥é¡¹**ï¼š
- âœ… æå–æ‰€æœ‰æœ¯è¯­å®šä¹‰
- âœ… æŸ¥æ‰¾é‡å¤å®šä¹‰çš„æœ¯è¯­
- âœ… éªŒè¯æœ¯è¯­è¡¨æ ¼å¼ï¼ˆè‹±æ–‡å¯¹ç…§åˆ—ï¼‰

**ä½¿ç”¨æ–¹æ³•**ï¼š
```bash
./scripts/check-terminology.sh
```

**è¾“å‡ºç¤ºä¾‹**ï¼š
```
ğŸ” å¼€å§‹ ADR æœ¯è¯­ä¸€è‡´æ€§æ£€æŸ¥...

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
æ£€æŸ¥ 1: æå–æ‰€æœ‰æœ¯è¯­å®šä¹‰
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ… æå–äº† 192 ä¸ªæœ¯è¯­å®šä¹‰

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
æ£€æŸ¥ 2: æŸ¥æ‰¾é‡å¤å®šä¹‰çš„æœ¯è¯­
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âš ï¸  å‘ç° 2 ä¸ªæœ¯è¯­åœ¨å¤šä¸ª ADR ä¸­å®šä¹‰ï¼š

æœ¯è¯­ 'æ¨¡å—åŒ–å•ä½“' åœ¨ä»¥ä¸‹ ADR ä¸­å®šä¹‰ï¼š
  â€¢ ADR-0001-modular-monolith-vertical-slice-architecture.md
  â€¢ ADR-0006-terminology-numbering-constitution.md
```

---

## CI/CD é›†æˆ

### GitHub Actions é›†æˆç¤ºä¾‹

åœ¨ `.github/workflows/adr-validation.yml` ä¸­ï¼š

```yaml
name: ADR Validation

on:
  pull_request:
    paths:
      - 'docs/adr/**'
  schedule:
    - cron: '0 0 * * 0'  # æ¯å‘¨æ—¥è¿è¡Œ

jobs:
  validate:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Check ADR Consistency
        run: ./scripts/check-adr-consistency.sh
        continue-on-error: true
      
      - name: Validate Relationships
        run: python3 scripts/validate-adr-relationships.py
        continue-on-error: true
      
      - name: Check Terminology
        run: ./scripts/check-terminology.sh
        continue-on-error: true
```

---

## å½“å‰å‘ç°çš„é—®é¢˜ç»Ÿè®¡

åŸºäºæœ€è¿‘çš„éªŒè¯è¿è¡Œï¼š

| æ£€æŸ¥ç±»åˆ« | å‘ç°é—®é¢˜æ•° | ä¸¥é‡ç¨‹åº¦ |
|---------|-----------|---------|
| ç¼ºå°‘ Front Matter | 30 | ğŸ”´ é«˜ |
| æœ¯è¯­è¡¨æ ¼å¼ä¸ç¬¦ | 17 | ğŸŸ¡ ä¸­ |
| å…³ç³»å£°æ˜ä¸ä¸€è‡´ | 1 | ğŸŸ  ä¸­é«˜ |
| ç‰ˆæœ¬å·æ ¼å¼é—®é¢˜ | 0 | âœ… æ—  |

---

## æ•´æ”¹ä¼˜å…ˆçº§

æ ¹æ® [ADR åŒæ­¥æ€§åˆ†ææŠ¥å‘Š](../docs/reports/adr-synchronization-analysis-2026-01-29.md)ï¼š

### P0 é—®é¢˜ï¼ˆ7å¤©å†…ä¿®å¤ï¼‰
- âœ… å®ªæ³•å±‚ ADR (0001-0008) ç¼ºå°‘ Front Matter
- âœ… æœ¯è¯­è¡¨ç¼ºå°‘è‹±æ–‡å¯¹ç…§åˆ—

### P1 é—®é¢˜ï¼ˆ14å¤©å†…ä¿®å¤ï¼‰
- âœ… åŒå‘å…³ç³»å£°æ˜ä¸ä¸€è‡´
- âœ… å…³ç³»æ ¼å¼ä¸ç¬¦åˆ ADR-940 æ ‡å‡†

### P2 é—®é¢˜ï¼ˆ30å¤©å†…ä¿®å¤ï¼‰
- âœ… å…¶ä»–å±‚çº§ ADR ç¼ºå°‘ Front Matter
- âœ… ç‰ˆæœ¬å†å²è®°å½•ä¸å®Œæ•´

---

## å·¥å…·å¼€å‘æŒ‡å—

### æ·»åŠ æ–°çš„æ£€æŸ¥é¡¹

1. ç¡®å®šæ£€æŸ¥çš„ ADR ä¾æ®ï¼ˆå¦‚ ADR-902ã€ADR-940 ç­‰ï¼‰
2. åœ¨ç›¸åº”è„šæœ¬ä¸­æ·»åŠ æ–°çš„æ£€æŸ¥å‡½æ•°
3. æ›´æ–°æœ¬ README æ–‡æ¡£
4. æäº¤ PR å¹¶æ ‡æ³¨ `adr-tooling` æ ‡ç­¾

### è„šæœ¬ç¼–å†™è§„èŒƒ

- âœ… ä½¿ç”¨é¢œè‰²è¾“å‡ºæé«˜å¯è¯»æ€§
- âœ… æä¾›æ¸…æ™°çš„é”™è¯¯æ¶ˆæ¯å’Œä¿®å¤å»ºè®®
- âœ… æ”¯æŒ CI/CD ç¯å¢ƒï¼ˆè¿”å›æ­£ç¡®çš„é€€å‡ºç ï¼‰
- âœ… åŒ…å«è¿›åº¦æŒ‡ç¤ºå’Œç»Ÿè®¡ä¿¡æ¯
- âœ… å¼•ç”¨ç›¸å…³ ADR ç¼–å·

---

## æ•…éšœæ’æŸ¥

### é—®é¢˜ï¼šè„šæœ¬æƒé™ä¸è¶³

**è§£å†³**ï¼š
```bash
chmod +x scripts/check-adr-consistency.sh
chmod +x scripts/check-terminology.sh
```

### é—®é¢˜ï¼šPython è„šæœ¬æ‰¾ä¸åˆ° ADR ç›®å½•

**è§£å†³**ï¼šç¡®ä¿åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œè„šæœ¬
```bash
cd /path/to/Zss.BilliardHall
python3 ./scripts/validate-adr-relationships.py
```

### é—®é¢˜ï¼šé¢œè‰²ä»£ç åœ¨æŸäº›ç»ˆç«¯ä¸æ˜¾ç¤º

**è§£å†³**ï¼šæŸäº› CI ç¯å¢ƒå¯èƒ½ä¸æ”¯æŒ ANSI é¢œè‰²ï¼Œè¿™ä¸å½±å“åŠŸèƒ½

---

## ç›¸å…³èµ„æº

- ğŸ“˜ [ADR åŒæ­¥æ€§åˆ†ææŠ¥å‘Š](../docs/reports/adr-synchronization-analysis-2026-01-29.md)
- ğŸ“˜ [ADR-902: ADR æ ‡å‡†æ¨¡æ¿ä¸ç»“æ„å¥‘çº¦](../docs/adr/governance/ADR-902-adr-template-structure-contract.md)
- ğŸ“˜ [ADR-940: ADR å…³ç³»ä¸æº¯æºç®¡ç†](../docs/adr/governance/ADR-940-adr-relationship-traceability-management.md)
- ğŸ“˜ [ADR-980: ADR ç”Ÿå‘½å‘¨æœŸåŒæ­¥](../docs/adr/governance/ADR-980-adr-lifecycle-synchronization.md)

---

**ç»´æŠ¤è€…**ï¼šæ¶æ„å§”å‘˜ä¼š  
**æœ€åæ›´æ–°**ï¼š2026-01-29  
**çŠ¶æ€**ï¼šâœ… Active

---

### 4. ADR æµ‹è¯•è¦†ç›–ç‡æ£€æŸ¥å™¨ (`check-adr-test-coverage.sh`)

**ç”¨é€”**ï¼šæ‰«æ ADR æ–‡æ¡£ä¸å¯¹åº”æ¶æ„æµ‹è¯•çš„æ˜ å°„å…³ç³»ï¼Œè¯†åˆ«ç¼ºå¤±çš„æµ‹è¯•

**æ£€æŸ¥é¡¹**ï¼š
- âœ… ADR ä¸æµ‹è¯•æ–‡ä»¶ä¸€å¯¹ä¸€æ˜ å°„éªŒè¯
- âœ… æŒ‰å±‚çº§ç»Ÿè®¡æµ‹è¯•è¦†ç›–ç‡
- âœ… è¯†åˆ«æ ‡æ³¨ã€å¿…é¡»æ¶æ„æµ‹è¯•è¦†ç›–ã€‘ä½†ç¼ºå¤±æµ‹è¯•çš„ ADR
- âœ… ç”Ÿæˆç¼ºå¤±æµ‹è¯•è¯¦ç»†æ¸…å•

**ä½¿ç”¨æ–¹æ³•**ï¼š
```bash
./scripts/check-adr-test-coverage.sh
```

**è¾“å‡ºç¤ºä¾‹**ï¼š
```
======================================
  ADR æµ‹è¯•è¦†ç›–ç‡æ£€æŸ¥
======================================

ğŸ“ é¡¹ç›®è·¯å¾„: /path/to/Zss.BilliardHall
â° æ£€æŸ¥æ—¶é—´: 2026-01-29 10:30:00

======================================
  ç»Ÿè®¡æ¦‚è§ˆ
======================================

ğŸ“Š ADR æ–‡æ¡£æ€»æ•°:    45
ğŸ“Š æ¶æ„æµ‹è¯•æ€»æ•°:    26

======================================
  æŒ‰å±‚çº§ç»Ÿè®¡
======================================

ğŸ“ constitutional:
   - ADR æ€»æ•°: 8
   - å·²æµ‹è¯•: 8
   - è¦†ç›–ç‡: 100%
   - çŠ¶æ€: âœ… å®Œå…¨è¦†ç›–

ğŸ“ governance:
   - ADR æ€»æ•°: 25
   - å·²æµ‹è¯•: 3
   - è¦†ç›–ç‡: 12%
   - çŠ¶æ€: âŒ ä¸¥é‡ä¸è¶³

...

======================================
  ç¼ºå¤±æµ‹è¯•è¯¦ç»†åˆ—è¡¨
======================================

ğŸ“ governance å±‚ï¼ˆç¼ºå¤± 22 ä¸ªï¼‰:

   âŒ ADR-900: ADR æµç¨‹
      - æ ‡æ³¨å¿…é¡»æµ‹è¯•: âœ…
      - ä¼˜å…ˆçº§: ğŸ”´ P0
      - æœŸæœ›æ–‡ä»¶: src/tests/ArchitectureTests/ADR/ADR_0900_Architecture_Tests.cs

...

======================================
  åˆ¤å®šç»“æœ
======================================

âŒ ä¸¥é‡é—®é¢˜ï¼šå‘ç° 7 ä¸ªæ ‡æ³¨ã€å¿…é¡»æ¶æ„æµ‹è¯•è¦†ç›–ã€‘çš„ ADR ç¼ºå°‘æµ‹è¯•

âš ï¸  å»ºè®®ï¼š
   1. ç«‹å³ä¸ºæ ‡æ³¨ã€å¿…é¡»æ¶æ„æµ‹è¯•è¦†ç›–ã€‘çš„ ADR è¡¥å……æµ‹è¯•
   2. å‚è€ƒä¿®å¤è®¡åˆ’: docs/reports/adr-test-gap-analysis-2026-01-29.md
   3. ä½¿ç”¨æµ‹è¯•æ¨¡æ¿: src/tests/ArchitectureTests/ADR/ADR_0001_Architecture_Tests.cs
```

**é€€å‡ºä»£ç **ï¼š
- `0`ï¼šæ‰€æœ‰æ£€æŸ¥é€šè¿‡æˆ–è¦†ç›–ç‡ â‰¥ 80%
- `1`ï¼šå‘ç°æ ‡æ³¨ã€å¿…é¡»æ¶æ„æµ‹è¯•è¦†ç›–ã€‘çš„ ADR ç¼ºå°‘æµ‹è¯•

**ä¾æ® ADR**ï¼š
- ADR-0000ï¼ˆæ¶æ„æµ‹è¯•ä¸ CI æ²»ç†å®ªæ³•ï¼‰
- ADR-904ï¼ˆæ¶æ„æµ‹è¯•æœ€å°æ–­è¨€è¯­ä¹‰ï¼‰

**ç›¸å…³æ–‡æ¡£**ï¼š
- ğŸ“˜ [ADR æµ‹è¯•ç¼ºå¤±è¯¦ç»†åˆ†æ](../docs/reports/adr-test-gap-analysis-2026-01-29.md)
- ğŸ“˜ [ADR æµ‹è¯•ç¼ºå¤±æ‰§è¡Œæ‘˜è¦](../docs/reports/adr-test-gap-summary.md)

---

## CI/CD é›†æˆå»ºè®®

### GitHub Actions å·¥ä½œæµç¤ºä¾‹

åˆ›å»º `.github/workflows/adr-validation.yml`ï¼š

```yaml
name: ADR Validation

on:
  pull_request:
    paths:
      - 'docs/adr/**/*.md'
      - 'src/tests/ArchitectureTests/**/*.cs'
  schedule:
    - cron: '0 0 * * 1'  # æ¯å‘¨ä¸€è¿è¡Œ

jobs:
  validate-adrs:
    runs-on: ubuntu-latest
    
    steps:
      - uses: actions/checkout@v3
      
      - name: Check ADR Consistency
        run: ./scripts/check-adr-consistency.sh
        
      - name: Validate ADR Relationships
        run: python3 ./scripts/validate-adr-relationships.py
        
      - name: Check Terminology
        run: ./scripts/check-terminology.sh
        
      - name: Check Test Coverage
        run: ./scripts/check-adr-test-coverage.sh
```

### Pre-commit Hook

å°†å·¥å…·é›†æˆåˆ° Git pre-commit hookï¼š

```bash
#!/bin/bash
# .git/hooks/pre-commit

echo "Running ADR validation..."

# åªæ£€æŸ¥æœ‰å˜æ›´çš„ ADR æ–‡ä»¶
changed_adrs=$(git diff --cached --name-only | grep "docs/adr/.*\.md$")

if [ -n "$changed_adrs" ]; then
    ./scripts/check-adr-consistency.sh || exit 1
    python3 ./scripts/validate-adr-relationships.py || exit 1
    ./scripts/check-adr-test-coverage.sh || exit 1
fi

echo "âœ… ADR validation passed"
```

---

## å·¥å…·ç‰ˆæœ¬å†å²

| ç‰ˆæœ¬ | æ—¥æœŸ | å˜æ›´å†…å®¹ |
|-----|------|---------|
| 3.0 | 2026-01-29 | æ–°å¢ ADR æµ‹è¯•è¦†ç›–ç‡æ£€æŸ¥å™¨ |
| 2.0 | 2026-01-29 | æ”¹è¿›å…³ç³»éªŒè¯å™¨ï¼Œæ”¯æŒå¤šè¡Œå…³ç³»å£°æ˜ |
| 1.0 | 2026-01-29 | åˆå§‹ç‰ˆæœ¬ï¼ŒåŒ…å«ä¸€è‡´æ€§ã€å…³ç³»ã€æœ¯è¯­æ£€æŸ¥å™¨ |

---

**ç»´æŠ¤è€…**ï¼šæ¶æ„å§”å‘˜ä¼š  
**æœ€åæ›´æ–°**ï¼š2026-01-29  
**çŠ¶æ€**ï¼šâœ… Active
