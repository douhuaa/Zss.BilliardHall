---
title: "ä»£ç é£æ ¼"
description: "C# ä»£ç é£æ ¼è§„èŒƒå’Œé¡¹ç›®ç¼–ç æ ‡å‡†"
section: "6.1"
version: "1.0.0"
author: "æŠ€æœ¯è´Ÿè´£äºº"
maintainer: "å…¨ä½“å¼€å‘äººå‘˜"
created: "2024-01-01"
updated: "2024-01-15"
category: "å¼€å‘è§„èŒƒ"
level: "å¿…è¯»"
audience: ["å…¨ä½“å¼€å‘äººå‘˜"]
keywords: ["ä»£ç é£æ ¼", "C#è§„èŒƒ", "ç¼–ç æ ‡å‡†", "EditorConfig", "å‘½åçº¦å®š"]
tags: ["coding-standards", "csharp", "style-guide", "formatting"]
status: "å®Œæˆ"
dependencies: []
related_docs: ["06_å¼€å‘è§„èŒƒ/åˆ†å±‚çº¦æŸ.md", "06_å¼€å‘è§„èŒƒ/CodeReviewæµç¨‹.md"]
reading_time: "20åˆ†é’Ÿ"
difficulty: "åˆçº§"
---

# 6.1 ä»£ç é£æ ¼

**å¯¼èˆªè·¯å¾„**: [ğŸ  é¡¹ç›®æ–‡æ¡£é¦–é¡µ](../è‡ªåŠ©å°çƒç³»ç»Ÿé¡¹ç›®æ–‡æ¡£.md) > [ğŸ“ å¼€å‘è§„èŒƒ](README.md) > ğŸ¨ ä»£ç é£æ ¼  
**å…³é”®è¯**: `ä»£ç é£æ ¼` `C#è§„èŒƒ` `ç¼–ç æ ‡å‡†` `EditorConfig` `å‘½åçº¦å®š`

## æ¦‚è¿°

æœ¬è§„èŒƒç»Ÿä¸€ C# / ç›¸å…³å±‚ä»£ç çš„å‘½åã€æ ¼å¼ã€ç»“æ„ä¸æ³¨é‡Šï¼Œå‡å°‘é£æ ¼å·®å¼‚ï¼Œæå‡å¯ç»´æŠ¤æ€§ã€‚è‹¥ä¸ä¸šåŠ¡æ¶æ„å†²çªï¼Œä»¥ã€Šåˆ†å±‚çº¦æŸã€‹ä¼˜å…ˆï¼›å¦‚ä¸å·¥å…·è‡ªåŠ¨æ ¼å¼åŒ–å†²çªï¼Œä»¥ `.editorconfig` è¾“å‡ºç»“æœä¸ºå‡†ã€‚

> å…³è”æ–‡æ¡£ï¼š [6.2 åˆ†å±‚çº¦æŸ](åˆ†å±‚çº¦æŸ.md) Â· [6.3 æ—¥å¿—è§„èŒƒ](æ—¥å¿—è§„èŒƒ.md) Â· [6.5 Code Review æµç¨‹](CodeReviewæµç¨‹.md)

## ç›®å½•

1. [å‘½åçº¦å®š](#å‘½åçº¦å®š)  
2. [ä»£ç æ ¼å¼åŒ–](#ä»£ç æ ¼å¼åŒ–)  
3. [è¯­æ³•ä¸ç»“æ„é£æ ¼](#è¯­æ³•ä¸ç»“æ„é£æ ¼)  
4. [æ³¨é‡Šè§„èŒƒ](#æ³¨é‡Šè§„èŒƒ)  
5. [å¼‚å¸¸å¤„ç†è§„èŒƒ](#å¼‚å¸¸å¤„ç†è§„èŒƒ)  
6. [å¼‚æ­¥ä¸ LINQ](#å¼‚æ­¥ä¸-linq)  
7. [æ€§èƒ½ä¸èµ„æºç®¡ç†](#æ€§èƒ½ä¸èµ„æºç®¡ç†)  
8. [å­—ç¬¦ä¸²ä¸é›†åˆå¤„ç†](#å­—ç¬¦ä¸²ä¸é›†åˆå¤„ç†)  
9. [ä»£ç åˆ†æä¸é™æ€æ£€æŸ¥](#ä»£ç åˆ†æä¸-é™æ€æ£€æŸ¥)  
10. [æäº¤ä¿¡æ¯è§„èŒƒé›†æˆ](#æäº¤ä¿¡æ¯è§„èŒƒé›†æˆ)  
11. [é™„å½•ä¸ç›¸å…³æ–‡æ¡£](#é™„å½•ä¸ç›¸å…³æ–‡æ¡£)

---

## å‘½åçº¦å®š

### 1. ç±»å’Œæ¥å£å‘½å

```csharp
// âœ… æ­£ç¡®ï¼šä½¿ç”¨ PascalCaseï¼Œåè¯æˆ–åè¯çŸ­è¯­
public class BilliardTable { }
public class TableSessionManager { }
public class PaymentService { }

// âœ… æ¥å£ä»¥ I å¼€å¤´
public interface IPaymentService { }
public interface ITableRepository { }

// âŒ é”™è¯¯ï¼šä¸ä½¿ç”¨ä¸‹åˆ’çº¿ã€åŒˆç‰™åˆ©å‘½åæ³•
public class billiardTable { }
public class IBilliardTable { }
public class strPaymentService { }
```

### 2. æ–¹æ³•å‘½å

```csharp
// âœ… æ­£ç¡®ï¼šä½¿ç”¨ PascalCaseï¼ŒåŠ¨è¯æˆ–åŠ¨è¯çŸ­è¯­
public async Task<TableSession> StartSessionAsync(long tableId, long userId)
{
    // å®ç°...
}

public bool IsTableAvailable(long tableId)
{
    // å®ç°...
}

public void UpdateTableStatus(long tableId, TableStatus status)
{
    // å®ç°...
}

// âŒ é”™è¯¯ï¼šä¸æ¸…æ™°çš„å‘½å
public void DoSomething() { }
public void Process() { }
```

### 3. å˜é‡å’Œå­—æ®µå‘½å

```csharp
public class TableService
{
    // âœ… ç§æœ‰å­—æ®µä½¿ç”¨ camelCase åŠ ä¸‹åˆ’çº¿å‰ç¼€
    private readonly ITableRepository _tableRepository;
    private readonly ILogger<TableService> _logger;
    private static readonly TimeSpan DefaultTimeout = TimeSpan.FromMinutes(30);
    
    // âœ… å…¬å…±å±æ€§ä½¿ç”¨ PascalCase
    public DateTime LastUpdated { get; set; }
    public TableStatus Status { get; private set; }
    
    public async Task<bool> CheckAvailabilityAsync(long tableId)
    {
        // âœ… å±€éƒ¨å˜é‡ä½¿ç”¨ camelCase
        var currentTime = DateTime.Now;
        var table = await _tableRepository.GetAsync(tableId);
        var isAvailable = table.Status == TableStatus.Available;
        
        return isAvailable;
    }
}
```

### 4. å¸¸é‡å’Œæšä¸¾

```csharp
// âœ… å¸¸é‡ä½¿ç”¨ PascalCase
public static class TableConstants
{
    public const int MaxTableNumber = 999;
    public const decimal DefaultHourlyRate = 30.00m;
    public const string DefaultTablePrefix = "TABLE_";
}

// âœ… æšä¸¾å’Œæšä¸¾å€¼ä½¿ç”¨ PascalCase
public enum TableStatus
{
    Available = 1,
    Occupied = 2,
    Reserved = 3,
    Maintenance = 4,
    OutOfOrder = 5
}

public enum PaymentMethod
{
    WeChatPay = 1,
    Alipay = 2,
    CreditCard = 3,
    Cash = 4
}
```

## ä»£ç æ ¼å¼åŒ–

### 1. EditorConfig é…ç½®

åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º `.editorconfig` æ–‡ä»¶ï¼š

```ini
# EditorConfig is awesome: https://EditorConfig.org

# top-most EditorConfig file
root = true

# All files
[*]
charset = utf-8
insert_final_newline = true
trim_trailing_whitespace = true

# C# files
[*.cs]
indent_style = space
indent_size = 4
end_of_line = crlf

# Code style rules
dotnet_sort_system_directives_first = true
dotnet_separate_import_directive_groups = false

# Organize usings
dotnet_sort_system_directives_first = true
dotnet_separate_import_directive_groups = false

# this. preferences
dotnet_style_qualification_for_field = false:warning
dotnet_style_qualification_for_property = false:warning
dotnet_style_qualification_for_method = false:warning
dotnet_style_qualification_for_event = false:warning

# Language keywords vs BCL types preferences
dotnet_style_predefined_type_for_locals_parameters_members = true:warning
dotnet_style_predefined_type_for_member_access = true:warning

# Parentheses preferences
dotnet_style_parentheses_in_arithmetic_binary_operators = always_for_clarity:suggestion
dotnet_style_parentheses_in_relational_binary_operators = always_for_clarity:suggestion

# Modifier preferences
dotnet_style_require_accessibility_modifiers = always:warning
dotnet_style_readonly_field = true:warning

# Expression-level preferences
dotnet_style_object_initializer = true:suggestion
dotnet_style_collection_initializer = true:suggestion
dotnet_style_explicit_tuple_names = true:warning
dotnet_style_null_propagation = true:suggestion
dotnet_style_coalesce_expression = true:suggestion
dotnet_style_prefer_is_null_check_over_reference_equality_method = true:suggestion

# C# Code Style Rules
[*.cs]

# var preferences
csharp_style_var_for_built_in_types = false:warning
csharp_style_var_when_type_is_apparent = true:suggestion
csharp_style_var_elsewhere = false:suggestion

# Expression-bodied members
csharp_style_expression_bodied_methods = when_on_single_line:suggestion
csharp_style_expression_bodied_constructors = false:warning
csharp_style_expression_bodied_operators = when_on_single_line:suggestion
csharp_style_expression_bodied_properties = when_on_single_line:suggestion
csharp_style_expression_bodied_indexers = when_on_single_line:suggestion
csharp_style_expression_bodied_accessors = when_on_single_line:suggestion

# Pattern matching preferences
csharp_style_pattern_matching_over_is_with_cast_check = true:suggestion
csharp_style_pattern_matching_over_as_with_null_check = true:suggestion

# Null-checking preferences
csharp_style_throw_expression = true:suggestion
csharp_style_conditional_delegate_call = true:suggestion

# Modifier preferences
csharp_preferred_modifier_order = public,private,protected,internal,static,extern,new,virtual,abstract,sealed,override,readonly,unsafe,volatile,async:suggestion

# Expression-level preferences
csharp_prefer_braces = true:warning
csharp_style_deconstructed_variable_declaration = true:suggestion
csharp_prefer_simple_using_statement = true:suggestion
csharp_style_pattern_local_over_anonymous_function = true:suggestion

# C# Formatting Rules
csharp_new_line_before_open_brace = all
csharp_new_line_before_else = true
csharp_new_line_before_catch = true
csharp_new_line_before_finally = true
csharp_new_line_before_members_in_object_initializers = true
csharp_new_line_before_members_in_anonymous_types = true
csharp_new_line_between_query_expression_clauses = true

# Indentation preferences
csharp_indent_case_contents = true
csharp_indent_switch_labels = true
csharp_indent_labels = flush_left

# Space preferences
csharp_space_after_cast = false
csharp_space_after_keywords_in_control_flow_statements = true
csharp_space_between_method_call_parameter_list_parentheses = false
csharp_space_between_method_declaration_parameter_list_parentheses = false
csharp_space_between_parentheses = false
csharp_space_before_colon_in_inheritance_clause = true
csharp_space_after_colon_in_inheritance_clause = true
csharp_space_around_binary_operators = before_and_after
csharp_space_between_method_declaration_empty_parameter_list_parentheses = false
csharp_space_between_method_call_name_and_opening_parenthesis = false
csharp_space_between_method_call_empty_parameter_list_parentheses = false

# Wrapping preferences
csharp_preserve_single_line_statements = true
csharp_preserve_single_line_blocks = true

# Naming conventions
dotnet_naming_rule.interface_should_be_prefixed_with_i.severity = warning
dotnet_naming_rule.interface_should_be_prefixed_with_i.symbols = interface
dotnet_naming_rule.interface_should_be_prefixed_with_i.style = prefix_interface_with_i

dotnet_naming_rule.types_should_be_pascal_case.severity = warning
dotnet_naming_rule.types_should_be_pascal_case.symbols = types
dotnet_naming_rule.types_should_be_pascal_case.style = pascal_case

dotnet_naming_rule.non_field_members_should_be_pascal_case.severity = warning
dotnet_naming_rule.non_field_members_should_be_pascal_case.symbols = non_field_members
dotnet_naming_rule.non_field_members_should_be_pascal_case.style = pascal_case

# Symbol specifications
dotnet_naming_symbols.interface.applicable_kinds = interface
dotnet_naming_symbols.interface.applicable_accessibilities = public, internal, private, protected, protected_internal, private_protected

dotnet_naming_symbols.types.applicable_kinds = class, struct, interface, enum
dotnet_naming_symbols.types.applicable_accessibilities = public, internal, private, protected, protected_internal, private_protected

dotnet_naming_symbols.non_field_members.applicable_kinds = property, event, method
dotnet_naming_symbols.non_field_members.applicable_accessibilities = public, internal, private, protected, protected_internal, private_protected

# Naming styles
dotnet_naming_style.pascal_case.capitalization = pascal_case

dotnet_naming_style.prefix_interface_with_i.capitalization = pascal_case
dotnet_naming_style.prefix_interface_with_i.required_prefix = I
```

### 2. è‡ªåŠ¨åŒ–æ ¼å¼åŒ–å·¥å…·

#### dotnet-format ä½¿ç”¨

ç»Ÿä¸€ä½¿ç”¨ `dotnet-format` è¿›è¡Œ C# ä»£ç è‡ªåŠ¨æ ¼å¼åŒ–ä¸é£æ ¼æ ¡éªŒï¼Œè§„èŒƒæ¥æºäº `.editorconfig`ã€‚

å®‰è£…ï¼ˆæœ¬åœ°ä¸€æ¬¡å³å¯ï¼‰ï¼š

```bash
dotnet tool install --global dotnet-format
```

å‡çº§ï¼š

```bash
dotnet tool update --global dotnet-format
```

é¡¹ç›®å¿«æ·æ£€æŸ¥ï¼ˆä»…åˆ†æä¸å†™å…¥ï¼‰ï¼š

```bash
dotnet format --verify-no-changes
```

è‡ªåŠ¨ä¿®å¤ï¼š

```bash
dotnet format
```

CI å»ºè®®åœ¨æ„å»ºå‰åŠ å…¥ï¼š

```bash
dotnet format --verify-no-changes || (echo "Formatting diff found" && exit 1)
```

> æ³¨æ„ï¼šè¯·å‹¿åœ¨å°šæœªå®Œæˆçš„å¤§è§„æ¨¡é‡æ„åˆ†æ”¯ä¸Šç›²ç›®è¿è¡Œè¦†ç›–å¼æ ¼å¼åŒ–ï¼Œä»¥å…æ”¾å¤§ PR diffï¼›å¯åœ¨åˆå¹¶å‰å•ç‹¬ä¸€æ¬¡æ ¼å¼åŒ–æäº¤ã€‚

#### VS / Rider å¿«æ·é›†æˆ

- Riderï¼šå¯ç”¨ â€œRun 'dotnet format' on Saveâ€ æ’ä»¶æˆ–ä½¿ç”¨å†…ç½® Code Cleanup é…ç½®ä¸ `.editorconfig` åŒæ­¥ã€‚
- VSï¼šç¡®ä¿ `è‡ªåŠ¨æ ¼å¼åŒ–` å¯ç”¨ï¼Œå¹¶å®šæœŸè¿è¡Œå¤–éƒ¨å·¥å…·è„šæœ¬ã€‚

#### å‰ç«¯ (uniapp) ä»£ç å»ºè®®

å‰ç«¯ï¼ˆuniappï¼‰åç»­å»ºè®®å¼•å…¥ï¼š

```bash
npm i -D eslint @typescript-eslint/parser @typescript-eslint/eslint-plugin prettier eslint-plugin-vue
```

ç»Ÿä¸€é€šè¿‡ `npm run lint` ä¸ `npm run format`ï¼›å½“å‰æš‚æœªå¼ºåˆ¶ï¼Œå¼•å…¥æ—¶éœ€è¡¥å……å¯¹åº”æ–‡æ¡£ã€‚

## è¯­æ³•ä¸ç»“æ„é£æ ¼

### 1. å¤§æ‹¬å·ä¸ç¼©è¿›

ä½¿ç”¨ Allman é£æ ¼ï¼ˆå·²ç”± `.editorconfig` å¼ºåˆ¶ï¼‰ï¼Œæ‰€æœ‰ `if/else/for/while` ä¸æ–¹æ³• / ç±» / å‘½åç©ºé—´ å‡ç‹¬ç«‹æ¢è¡Œã€‚

### 2. ç©ºæ ¼ä¸å¸ƒå±€

- é€»è¾‘è¿ç®—ç¬¦ã€èµ‹å€¼ã€æ¯”è¾ƒè¿ç®—ç¬¦ä¸¤ä¾§ä¿ç•™ç©ºæ ¼ã€‚
- å‚æ•°åˆ—è¡¨ã€å¯¹è±¡/é›†åˆåˆå§‹åŒ–éµå¾ªå·¥å…·åŒ–è¾“å‡ºï¼Œä¸æ‰‹å·¥ç»•æ ¼å¼ã€‚
- å•è¡Œ `if` ä¸å…è®¸çœç•¥å¤§æ‹¬å·ã€‚

### 3. `var` ä½¿ç”¨

| åœºæ™¯ | æ˜¯å¦ä½¿ç”¨ var | è¯´æ˜ |
|------|--------------|------|
| å³å€¼å«ç±»å‹å `new ClassName()` | âœ… | å¯è¯»æ€§æ˜ç¡® |
| åŸºç¡€ç±»å‹å­—é¢é‡ `int i = 0` | âŒ | ç›´æ¥å†™å‡ºç±»å‹ |
| LINQ æŠ•å½±å¤æ‚åŒ¿åç±»å‹ | âœ… | æ— æ³•æ˜¾å¼å‘½å |
| è¿”å›æ¥å£/æŠ½è±¡çš„å¤šæ€å®ä¾‹ | âŒ | ä¿æŒå£°æ˜è¯­ä¹‰æ¸…æ™° |

### 4. æ–¹æ³•ä½“ä¸æ‹†åˆ†

- å•ä¸ªæ–¹æ³•å»ºè®® â‰¤ 50 è¡Œï¼›è¶…å‡ºéœ€è¯„ä¼°é‡æ„ã€‚
- ä¸šåŠ¡ç»„åˆé€»è¾‘ç½®äº Applicationï¼›é¢†åŸŸè§„åˆ™ç•™åœ¨ Domainã€‚

### 5. å¼‚æ­¥å‘½å

- æ‰€æœ‰ `Task/ValueTask` è¿”å›çš„å…¬å¼€æˆå‘˜ä»¥ `Async` ç»“å°¾ã€‚
- ç¦æ­¢åŒæ­¥åŒ…è£…å¼‚æ­¥ï¼šé¿å… `.Result` / `.GetAwaiter().GetResult()`ã€‚

### 6. åˆ†å±‚çº¦æŸå¼•ç”¨

- Application ä¸ç›´æ¥ new åŸºç¡€è®¾æ–½å®ç°ï¼ˆé€šè¿‡ IoCï¼‰ã€‚
- Domain ä¸å‡ºç° HTTP / EF Core / åºåˆ—åŒ–æ¡†æ¶å…·ä½“ç±»å‹ã€‚

## æ³¨é‡Šè§„èŒƒ

éµå¾ª Conventional Commitsï¼›åœ¨ä»“åº“æ ¹ç›®å½•æ”¾ç½® `.gitmessage.txt` ä½œä¸º Git æäº¤æ¨¡æ¿ã€‚

é…ç½®ï¼ˆä¸€æ¬¡æ€§ï¼‰ï¼š

```bash
git config commit.template .gitmessage.txt
```

æ¨¡æ¿ç¤ºä¾‹ç‰‡æ®µï¼š

```text
feat(table-session): æ”¯æŒå°çƒæ¡Œæš‚åœä¸æ¢å¤

è¯¦ç»†è¯´æ˜ï¼ˆå¯é€‰ï¼‰ï¼š
- èƒŒæ™¯/åŠ¨æœº
- ä¿®æ”¹ç‚¹
- å½±å“èŒƒå›´

BREAKING CHANGE: æ—§æ¥å£å·²ç§»é™¤ï¼Œè¯·è¿ç§»è‡³ /api/table-sessions/new-cost
```

ç±»å‹è¯´æ˜ï¼š`feat` æ–°åŠŸèƒ½ï¼Œ`fix` ä¿®å¤ç¼ºé™·ï¼Œ`docs` æ–‡æ¡£ï¼Œ`refactor` é‡æ„ï¼ˆæ— æ–°åŠŸèƒ½/ä¿®å¤ï¼‰ï¼Œ`perf` æ€§èƒ½ï¼Œ`test` æµ‹è¯•ï¼Œ`build` æ„å»º/ä¾èµ–ï¼Œ`chore` æ‚é¡¹ï¼Œ`ci` æµæ°´çº¿ï¼Œ`security` å®‰å…¨ä¿®å¤ã€‚

> è‹¥åŒæ—¶åŒ…å«â€œå¤§é‡æ ¼å¼åŒ– + åŠŸèƒ½ä¿®æ”¹â€ï¼Œå¿…é¡»æ‹†åˆ†è‡³å°‘ä¸¤ä¸ªæäº¤ï¼Œä¾¿äºå®¡æŸ¥ã€‚


## 2. å¤§æ‹¬å·å’Œç¼©è¿›

```csharp
// âœ… æ­£ç¡®ï¼šAllman é£æ ¼ï¼Œå¤§æ‹¬å·ç‹¬å ä¸€è¡Œ
public class TableService
{
    public async Task<TableSession> StartSessionAsync(long tableId)
    {
        if (tableId <= 0)
        {
            throw new ArgumentException("æ— æ•ˆçš„çƒå°ID", nameof(tableId));
        }

        }

}

    public async Task<TableSession> StartSessionAsync(long tableId) {
        // ...
    }
}
```

## 3. ç©ºæ ¼å’Œæ¢è¡Œ

```csharp
// âœ… æ­£ç¡®çš„ç©ºæ ¼ä½¿ç”¨
public async Task<bool> ValidateTableAsync(long tableId, DateTime startTime)
{
    var result = tableId > 0 && startTime > DateTime.Now;
    var tables = new List<BilliardTable> { table1, table2, table3 };
    
    if (result)
    {
        await DoSomethingAsync();
    }
    
    return result;
}

// âŒ é”™è¯¯çš„ç©ºæ ¼ä½¿ç”¨
public async Task<bool>ValidateTableAsync(long tableId,DateTime startTime)
{
    var result=tableId>0&&startTime>DateTime.Now;
    var tables=new List<BilliardTable>{table1,table2,table3};
    
    if(result)
    {
        await DoSomethingAsync();
    }
    
    return result;
}
```

## æ³¨é‡Šè§„èŒƒ

### 1. XML æ–‡æ¡£æ³¨é‡Š

```csharp
/// <summary>
/// çƒå°æœåŠ¡ç±»ï¼Œæä¾›çƒå°çŠ¶æ€ç®¡ç†å’Œä¼šè¯æ§åˆ¶åŠŸèƒ½
/// </summary>
public class TableService
{
    /// <summary>
    /// å¼€å§‹æ–°çš„å°çƒä¼šè¯
    /// </summary>
    /// <param name="tableId">çƒå°ID</param>
    /// <param name="userId">ç”¨æˆ·ID</param>
    /// <param name="startTime">å¼€å§‹æ—¶é—´ï¼Œå¦‚æœä¸ºnullåˆ™ä½¿ç”¨å½“å‰æ—¶é—´</param>
    /// <returns>è¿”å›åˆ›å»ºçš„ä¼šè¯å¯¹è±¡</returns>
    /// <exception cref="ArgumentException">å½“çƒå°IDæˆ–ç”¨æˆ·IDæ— æ•ˆæ—¶æŠ›å‡º</exception>
    /// <exception cref="InvalidOperationException">å½“çƒå°ä¸å¯ç”¨æ—¶æŠ›å‡º</exception>
    public async Task<TableSession> StartSessionAsync(
        long tableId, 
        long userId, 
        DateTime? startTime = null)
    {
        // å®ç°...
    }

    /// <summary>
    /// æ£€æŸ¥çƒå°æ˜¯å¦å¯ç”¨
    /// </summary>
    /// <param name="tableId">è¦æ£€æŸ¥çš„çƒå°ID</param>
    /// <returns>å¦‚æœçƒå°å¯ç”¨è¿”å› trueï¼Œå¦åˆ™è¿”å› false</returns>
    public async Task<bool> IsTableAvailableAsync(long tableId)
    {
        // å®ç°...
    }
}
```

### 2. è¡Œå†…æ³¨é‡Š

```csharp
public async Task<decimal> CalculateBillingAsync(TableSession session)
{
    // è·å–å½“å‰æ—¶é—´ï¼Œç”¨äºè®¡ç®—æ¸¸æˆæ—¶é•¿
    var currentTime = DateTime.Now;
    
    // è®¡ç®—å·²æ¸¸æˆçš„åˆ†é’Ÿæ•°
    var playedMinutes = (int)(currentTime - session.StartTime).TotalMinutes;
    
    // åº”ç”¨å®šä»·è§„åˆ™è®¡ç®—åŸºç¡€è´¹ç”¨
    var baseAmount = playedMinutes * session.HourlyRate / 60;
    
    // TODO: å®ç°ä¼˜æƒ è§„åˆ™è®¡ç®—
    var discountAmount = await CalculateDiscountAsync(session);
    
    return baseAmount - discountAmount;
}
```

### 3. æ³¨é‡Šæœ€ä½³å®è·µ

```csharp
// âœ… å¥½çš„æ³¨é‡Šï¼šè§£é‡Šä¸ºä»€ä¹ˆè¿™æ ·åš
public async Task UpdateTableHeartbeatAsync(long tableId)
{
    // ä½¿ç”¨ä¹è§‚é”é˜²æ­¢å¹¶å‘æ›´æ–°å¿ƒè·³æ—¶é—´å¯¼è‡´çš„æ•°æ®ç«äº‰
    var table = await _repository.GetAsync(tableId);
    table.LastHeartbeatTime = DateTime.Now;
    table.ConcurrencyStamp = Guid.NewGuid().ToString();
    
    await _repository.UpdateAsync(table);
}

// âŒ ä¸å¥½çš„æ³¨é‡Šï¼šé‡å¤ä»£ç å†…å®¹
public async Task UpdateTableHeartbeatAsync(long tableId)
{
    // è·å–çƒå°
    var table = await _repository.GetAsync(tableId);
    
    // è®¾ç½®å¿ƒè·³æ—¶é—´ä¸ºå½“å‰æ—¶é—´
    table.LastHeartbeatTime = DateTime.Now;
    
    // æ›´æ–°çƒå°
    await _repository.UpdateAsync(table);
}
```

## å¼‚å¸¸å¤„ç†è§„èŒƒ

### 1. å¼‚å¸¸æŠ›å‡º

```csharp
public class TableService
{
    public async Task<TableSession> StartSessionAsync(long tableId, long userId)
    {
        // âœ… å‚æ•°éªŒè¯ï¼ŒæŠ›å‡ºå…·ä½“çš„å¼‚å¸¸ç±»å‹
        if (tableId <= 0)
            throw new ArgumentException("çƒå°IDå¿…é¡»å¤§äº0", nameof(tableId));
            
        if (userId <= 0)
            throw new ArgumentException("ç”¨æˆ·IDå¿…é¡»å¤§äº0", nameof(userId));

        var table = await _tableRepository.FindAsync(tableId);
        
        // âœ… ä½¿ç”¨ä¸šåŠ¡å¼‚å¸¸ç±»å‹
        if (table == null)
            throw new EntityNotFoundException(typeof(BilliardTable), tableId);
            
        if (table.Status != TableStatus.Available)
            throw new BusinessException("çƒå°å½“å‰ä¸å¯ç”¨ï¼ŒçŠ¶æ€ï¼š" + table.Status);

        // å®ç°é€»è¾‘...
    }
}
```

### 2. å¼‚å¸¸å¤„ç†

```csharp
public async Task<ApiResponse<TableSession>> StartSessionAsync(StartSessionRequest request)
{
    try
    {
        var session = await _tableService.StartSessionAsync(request.TableId, request.UserId);
        
        return ApiResponse<TableSession>.Success(session);
    }
    catch (ArgumentException ex)
    {
        _logger.LogWarning(ex, "å¼€å°å‚æ•°éªŒè¯å¤±è´¥ï¼š{TableId}, {UserId}", 
            request.TableId, request.UserId);
        return ApiResponse<TableSession>.Fail("å‚æ•°é”™è¯¯ï¼š" + ex.Message);
    }
    catch (EntityNotFoundException ex)
    {
        _logger.LogWarning(ex, "çƒå°ä¸å­˜åœ¨ï¼š{TableId}", request.TableId);
        return ApiResponse<TableSession>.Fail("çƒå°ä¸å­˜åœ¨");
    }
    catch (BusinessException ex)
    {
        _logger.LogInformation(ex, "ä¸šåŠ¡è§„åˆ™éªŒè¯å¤±è´¥ï¼š{TableId}", request.TableId);
        return ApiResponse<TableSession>.Fail(ex.Message);
    }
    catch (Exception ex)
    {
        _logger.LogError(ex, "å¼€å°æ“ä½œå‘ç”Ÿæœªé¢„æœŸé”™è¯¯ï¼š{TableId}, {UserId}", 
            request.TableId, request.UserId);
        return ApiResponse<TableSession>.Fail("ç³»ç»Ÿé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•");
    }
}
```

## å¼‚æ­¥ä¸ LINQ

### 1. LINQ æŸ¥è¯¢é£æ ¼

```csharp
// âœ… æ¨èï¼šæ–¹æ³•è¯­æ³•ï¼Œé€‚åˆç®€å•æŸ¥è¯¢
var availableTables = await _context.BilliardTables
    .Where(t => t.StoreId == storeId && t.Status == TableStatus.Available)
    .OrderBy(t => t.TableNumber)
    .ToListAsync();

// âœ… æŸ¥è¯¢è¯­æ³•ï¼Œé€‚åˆå¤æ‚æŸ¥è¯¢
var sessionStats = from s in _context.TableSessions
                   join t in _context.BilliardTables on s.TableId equals t.Id
                   join u in _context.Users on s.UserId equals u.Id
                   where s.StartTime >= startDate && s.StartTime < endDate
                   group s by new { t.StoreId, Date = s.StartTime.Date } into g
                   select new SessionStatsDto
                   {
                       StoreId = g.Key.StoreId,
                       Date = g.Key.Date,
                       SessionCount = g.Count(),
                       TotalRevenue = g.Sum(x => x.FinalAmount)
                   };
```

### 2. å¼‚æ­¥æ–¹æ³•è§„èŒƒ

```csharp
// âœ… æ­£ç¡®çš„å¼‚æ­¥æ–¹æ³•å‘½åå’Œå®ç°
public async Task<List<BilliardTable>> GetAvailableTablesAsync(long storeId)
{
    return await _context.BilliardTables
        .Where(t => t.StoreId == storeId && t.Status == TableStatus.Available)
        .ToListAsync();
}

// âœ… æ­£ç¡®çš„ ConfigureAwait ä½¿ç”¨ï¼ˆåº“ä»£ç ä¸­ï¼‰
public async Task<TableSession> CreateSessionAsync(CreateSessionDto dto)
{
    var table = await _tableRepository.GetAsync(dto.TableId).ConfigureAwait(false);
    var user = await _userRepository.GetAsync(dto.UserId).ConfigureAwait(false);
    
    // åˆ›å»ºä¼šè¯é€»è¾‘...
    
    return session;
}

// âŒ é¿å…åŒæ­¥ç­‰å¾…å¼‚æ­¥æ–¹æ³•
public List<BilliardTable> GetAvailableTables(long storeId)
{
    // é”™è¯¯ï¼šå¯èƒ½å¯¼è‡´æ­»é”
    return GetAvailableTablesAsync(storeId).Result;
    
    // é”™è¯¯ï¼šé˜»å¡è°ƒç”¨
    return GetAvailableTablesAsync(storeId).GetAwaiter().GetResult();
}
```

## æ€§èƒ½ä¸èµ„æºç®¡ç†

### 1. ä½¿ç”¨ using è¯­å¥

```csharp
// âœ… ä¼ ç»Ÿ using è¯­å¥
public async Task<byte[]> ExportSessionDataAsync(long sessionId)
{
    using (var stream = new MemoryStream())
    using (var writer = new StreamWriter(stream))
    {
        var session = await _sessionRepository.GetAsync(sessionId);
        await writer.WriteLineAsync(JsonSerializer.Serialize(session));
        
        return stream.ToArray();
    }
}

// âœ… using å£°æ˜ï¼ˆC# 8.0+ï¼‰
public async Task<string> ReadConfigAsync(string filePath)
{
    using var reader = new StreamReader(filePath);
    return await reader.ReadToEndAsync();
}
```

## å­—ç¬¦ä¸²ä¸é›†åˆå¤„ç†

```csharp
// âœ… ä½¿ç”¨ StringBuilder å¤„ç†å¤šä¸ªå­—ç¬¦ä¸²è¿æ¥
public string GenerateReportContent(List<TableSession> sessions)
{
    var sb = new StringBuilder();
    
    foreach (var session in sessions)
    {
        sb.AppendLine($"ä¼šè¯ID: {session.Id}");
        sb.AppendLine($"çƒå°: {session.Table.TableNumber}");
        sb.AppendLine($"ç”¨æˆ·: {session.User.NickName}");
        sb.AppendLine($"è´¹ç”¨: {session.FinalAmount:C}");
        sb.AppendLine();
    }
    
    return sb.ToString();
}

// âœ… ä½¿ç”¨å­—ç¬¦ä¸²æ’å€¼
public string FormatSessionInfo(TableSession session)
{
    return $"ä¼šè¯ {session.Id} - çƒå° {session.Table.TableNumber} - " +
           $"ç”¨æˆ· {session.User.NickName} - è´¹ç”¨ {session.FinalAmount:C}";
}
```

## ä»£ç åˆ†æä¸ é™æ€æ£€æŸ¥

### 1. NuGet åŒ…é…ç½®

```xml
<!-- Directory.Build.props -->
<Project>
  <PropertyGroup>
    <TreatWarningsAsErrors>true</TreatWarningsAsErrors>
    <WarningsAsErrors />
    <WarningsNotAsErrors>CS1591</WarningsNotAsErrors>
    <EnableNETAnalyzers>true</EnableNETAnalyzers>
    <AnalysisMode>AllEnabledByDefault</AnalysisMode>
    <EnforceCodeStyleInBuild>true</EnforceCodeStyleInBuild>
  </PropertyGroup>
  
  <ItemGroup>
    <PackageReference Include="Microsoft.CodeAnalysis.Analyzers" Version="3.3.4" PrivateAssets="all" />
    <PackageReference Include="Microsoft.CodeAnalysis.NetAnalyzers" Version="7.0.0" PrivateAssets="all" />
    <PackageReference Include="StyleCop.Analyzers" Version="1.1.118" PrivateAssets="all" />
  </ItemGroup>
</Project>
```

### 2. StyleCop é…ç½®

```json
// stylecop.json
{
  "$schema": "https://raw.githubusercontent.com/DotNetAnalyzers/StyleCopAnalyzers/master/StyleCop.Analyzers/StyleCop.Analyzers/Settings/stylecop.schema.json",
  "settings": {
    "documentationRules": {
      "companyName": "è‡ªåŠ©å°çƒç³»ç»Ÿ",
      "copyrightText": "Copyright (c) {companyName}. All rights reserved."
    },
    "orderingRules": {
      "usingDirectivesPlacement": "outsideNamespace",
      "elementOrder": [
        "kind",
        "accessibility",
        "constant",
        "static",
        "readonly"
      ]
    }
  }
}
```

---

## æäº¤ä¿¡æ¯è§„èŒƒé›†æˆ

æ²¿ç”¨ Conventional Commitsï¼›è¯¦è§æ ¹ç›®å½• `.gitmessage.txt`ã€‚PR ä¸å¾—æ··åˆâ€œåŠŸèƒ½ + å¤§èŒƒå›´æ ¼å¼åŒ–â€â€”â€”éœ€æ‹†åˆ†æäº¤ã€‚

å¿«é€Ÿå‚è€ƒï¼š`feat` æ–°åŠŸèƒ½ / `fix` ç¼ºé™· / `docs` æ–‡æ¡£ / `refactor` é‡æ„ï¼ˆæ— åŠŸèƒ½å˜åŒ–ï¼‰/ `perf` æ€§èƒ½ / `test` æµ‹è¯• / `build` æ„å»ºä¾èµ– / `chore` æ‚é¡¹ / `ci` æµæ°´çº¿ / `security` å®‰å…¨ä¿®å¤ã€‚

## é™„å½•ä¸ç›¸å…³æ–‡æ¡£

### åŒçº§æ–‡æ¡£

- [6.2 åˆ†å±‚çº¦æŸ](åˆ†å±‚çº¦æŸ.md)
- [6.3 æ—¥å¿—è§„èŒƒ](æ—¥å¿—è§„èŒƒ.md)
- [6.4 Gitåˆ†æ”¯è§„èŒƒ](Gitåˆ†æ”¯è§„èŒƒ.md)
- [6.5 Code Reviewæµç¨‹](CodeReviewæµç¨‹.md)

### è¿”å›ä¸Šçº§

- [ğŸ”™ å¼€å‘è§„èŒƒæ€»è§ˆ](README.md)
- [ğŸ  é¡¹ç›®æ–‡æ¡£é¦–é¡µ](../è‡ªåŠ©å°çƒç³»ç»Ÿé¡¹ç›®æ–‡æ¡£.md)

### ç›¸å…³ç« èŠ‚

- [5. æ•°æ®åº“è®¾è®¡](../05_æ•°æ®åº“è®¾è®¡/README.md)
- [9. æµ‹è¯•æ–¹æ¡ˆ](../09_æµ‹è¯•æ–¹æ¡ˆ/README.md)
