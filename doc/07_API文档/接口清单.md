# 接口清单

## 图书管理 API (Book API)

### 1. 获取图书列表

**接口地址**: `GET /api/app/book`

**说明**: 获取图书分页列表

**请求参数**:
| 参数名 | 类型 | 必填 | 说明 | 示例 |
|--------|------|------|------|------|
| skipCount | number | 否 | 跳过的记录数 | 0 |
| maxResultCount | number | 否 | 最大返回数量 | 10 |
| sorting | string | 否 | 排序字段 | "Name" |

**响应示例**:
```json
{
  "items": [
    {
      "id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
      "name": "示例图书",
      "type": 1,
      "publishDate": "2024-01-01T00:00:00",
      "price": 29.99,
      "creationTime": "2024-01-01T10:00:00",
      "creatorId": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
      "lastModificationTime": "2024-01-02T10:00:00",
      "lastModifierId": "3fa85f64-5717-4562-b3fc-2c963f66afa6"
    }
  ],
  "totalCount": 100
}
```

**图书类型枚举** (BookType):
- 0: 未定义 (Undefined)
- 1: 冒险 (Adventure)
- 2: 传记 (Biography)
- 3: 反乌托邦 (Dystopia)
- 4: 奇幻 (Fantasy)
- 5: 恐怖 (Horror)
- 6: 科幻 (Science Fiction)

---

### 2. 获取图书详情

**接口地址**: `GET /api/app/book/{id}`

**说明**: 根据ID获取单个图书的详细信息

**路径参数**:
| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| id | string (GUID) | 是 | 图书ID |

**响应示例**:
```json
{
  "id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
  "name": "示例图书",
  "type": 1,
  "publishDate": "2024-01-01T00:00:00",
  "price": 29.99,
  "creationTime": "2024-01-01T10:00:00",
  "creatorId": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
  "lastModificationTime": "2024-01-02T10:00:00",
  "lastModifierId": "3fa85f64-5717-4562-b3fc-2c963f66afa6"
}
```

---

### 3. 创建图书

**接口地址**: `POST /api/app/book`

**说明**: 创建一本新图书

**权限要求**: `BilliardHall.Books.Create`

**请求体**:
```json
{
  "name": "新图书",
  "type": 1,
  "publishDate": "2024-01-01T00:00:00",
  "price": 29.99
}
```

**请求参数说明**:
| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| name | string | 是 | 图书名称 |
| type | number | 是 | 图书类型 (见枚举) |
| publishDate | string (ISO 8601) | 是 | 出版日期 |
| price | number | 是 | 价格 |

**响应示例**: 同"获取图书详情"

---

### 4. 更新图书

**接口地址**: `PUT /api/app/book/{id}`

**说明**: 更新现有图书信息

**权限要求**: `BilliardHall.Books.Edit`

**路径参数**:
| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| id | string (GUID) | 是 | 图书ID |

**请求体**: 同"创建图书"

**响应示例**: 同"获取图书详情"

---

### 5. 删除图书

**接口地址**: `DELETE /api/app/book/{id}`

**说明**: 删除指定图书

**权限要求**: `BilliardHall.Books.Delete`

**路径参数**:
| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| id | string (GUID) | 是 | 图书ID |

**响应**: 204 No Content

---

## 认证说明

所有 Book API 端点默认需要认证（获取列表和详情需要 `BilliardHall.Books.Default` 权限）。

请在请求头中携带认证令牌：
```
Authorization: Bearer {access_token}
```

## 错误处理

API 遵循标准的 HTTP 状态码：
- 200: 成功
- 201: 创建成功
- 204: 删除成功（无内容）
- 400: 请求参数错误
- 401: 未授权
- 403: 无权限
- 404: 资源不存在
- 500: 服务器内部错误

错误响应格式：
```json
{
  "error": {
    "code": "BilliardHall:Books:001",
    "message": "错误描述",
    "details": "详细信息"
  }
}
```

---

## UniApp 集成示例

在 UniApp 中使用 Book API：

```javascript
// 引入 API 模块
import { getBookList, getBook, createBook, updateBook, deleteBook } from '@/api/book';

// 获取图书列表
const loadBooks = async () => {
  try {
    const response = await getBookList({
      skipCount: 0,
      maxResultCount: 10,
      sorting: 'Name'
    });
    console.log('图书列表:', response.items);
    console.log('总数:', response.totalCount);
  } catch (error) {
    console.error('加载失败:', error);
  }
};

// 获取单个图书
const loadBookDetail = async (bookId) => {
  try {
    const book = await getBook(bookId);
    console.log('图书详情:', book);
  } catch (error) {
    console.error('加载失败:', error);
  }
};

// 创建图书
const addBook = async () => {
  try {
    const newBook = await createBook({
      name: '新图书',
      type: 1,
      publishDate: '2024-01-01T00:00:00',
      price: 29.99
    });
    console.log('创建成功:', newBook);
  } catch (error) {
    console.error('创建失败:', error);
  }
};
```

---

TODO: 添加其他业务模块的 API 文档（台球桌管理、计费会话、支付等）。
