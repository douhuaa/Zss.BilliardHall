# 部署流程

## CI/CD 流程

### GitHub Actions CI 工作流

项目使用 GitHub Actions 自动化 CI 流程，配置文件位于 `.github/workflows/ci.yml`。

#### 触发条件

- Pull Request 到 `main` 分支
- Push 到 `main` 分支

#### CI 步骤

1. **代码检出**: 使用 `actions/checkout@v4`
2. **.NET 环境设置**: 安装 .NET 10.0 预览版
3. **依赖还原**: `dotnet restore`
4. **代码格式检查**: `dotnet format --verify-no-changes`
   - 确保代码遵循项目格式规范
   - 若检查失败，需先运行 `dotnet format` 修复
5. **构建**: `dotnet build -c Release`
   - 编译所有项目
   - 运行代码分析器检查
6. **单元测试**: 运行 ServiceDefaults 单元测试
   - 收集测试结果（TRX 格式）
   - 收集代码覆盖率（XPlat Code Coverage）
   - 注：AppHost 集成测试需要基础设施，CI 中跳过
7. **上传测试结果**: 作为工件（Artifacts）保存

#### 本地验证 CI 步骤

在提交 PR 前，建议在本地运行以下命令验证：

```bash
cd src/Wolverine

# 1. 还原依赖
dotnet restore Zss.BilliardHall.Wolverine.slnx

# 2. 检查格式
dotnet format Zss.BilliardHall.Wolverine.slnx --verify-no-changes

# 3. 构建
dotnet build Zss.BilliardHall.Wolverine.slnx -c Release

# 4. 运行测试
dotnet test Aspire/Zss.BilliardHall.Wolverine.ServiceDefaults.Tests/Zss.BilliardHall.Wolverine.ServiceDefaults.Tests.csproj -c Release --no-build
```

### 发布流程

TODO: Release 流程、版本管理、部署到生产环境的步骤。

---

**参考文档**:
- [CodeReview 流程](../06_开发规范/CodeReview流程.md) - 完整的 PR 审查流程
- [代码风格](../06_开发规范/代码风格.md) - 代码格式规范

