# 文档编写指令

> ⚠️ **权威声明与冲突处理**：参阅 [base.instructions.md](base.instructions.md) 顶部的权威声明和末尾的治理协同章节。

## 适用场景：编写和维护文档

在协助文档工作时，在 `base.instructions.md` 的基础上应用这些指南。

## 权威依据

本文档服从以下 ADR：
- ADR-0008：文档编写与维护宪法

**冲突裁决**：若本文档与 ADR 正文冲突，以 ADR 正文为准。

**编写原则**：

- ADR 正文必须清晰、完整、可执行
- 辅导材料不得与 ADR 正文冲突
- 发现冲突时，以 ADR 正文为准并修正辅导材料

## 语言和风格

### 主要语言

- 所有文档必须使用**简体中文**，除非是：
  - 代码示例（使用相应的编程语言）
  - 常用的英文技术术语（如 "API"、"DTO"、"CQRS"）
  - 文件名和路径

### 语气和风格

- **清晰直接** - 不使用营销语言
- **以行动为导向** - 关注要做什么，而非仅概念
- **示例驱动** - 在适用的情况下始终包含代码示例
- **可扫描** - 使用标题、列表和表格

## 文档类型

⚠️ **重要提示**：在编写任何文档前，请先阅读 [最近 PR 常见问题总结](/docs/copilot/pr-common-issues.prompts.md)，避免重复前人的错误。

### 1. ADR（架构决策记录）

> **ADR 是系统的法律条文，不是架构师的解释说明。**

**位置**：`docs/adr/`

**结构**（必须遵循）：[ADR 模板](/docs/templates/adr-template.md)

**绝不做**：

- ❌ 在一个 ADR 中混合多个关注点
- ❌ 留下模糊的决策
- ❌ 跳过技术术语的术语表
- ❌ 忘记链接相关 ADR
- ❌ 包含解释性、指导性内容（应移至工程标准）
- ❌ 包含不可自动判定的规则
- ❌ 跨层越权（如运行层 ADR 定义技术实现）

### 2. Copilot Prompts

**位置**：`docs/copilot/`

**结构**（必须遵循）：[Prompt 模板](/docs/templates/copilot-pormpts-template.md)

**目的**：这些文件供 Copilot 参考，因此：

- 极其具体
- 包含完整的代码示例
- 展示 ❌ 错误和 ✅ 正确模式
- 提供确切的 CI 错误消息和解释

### 3. 用户指南

**位置**：`docs/`（根级别指南）

**特征**：

- 以清晰的目的陈述开始
- 对长指南包含目录
- 使用 mermaid 图表展示流程和关系
- 提供逐步说明
- 链接到相关 ADR 和 Prompts

## 格式标准

### 标题

使用清晰的层级

### 代码块

始终指定语言：

```markdown
```

### 列表

使用一致的格式：

```markdown
- 无序列表用于无序项
- 使用 `- [ ]` 表示清单
- 使用 `- [x]` 表示已完成项

1. 有序列表用于顺序步骤
2. 自然继续编号
```

### 表格

用于结构化比较：

```markdown
| 功能 | 描述 | 示例 |
|------|------|------|
| X    | 执行 Y | `code` |
```

### 标注

使用表情符号进行视觉强调：

```markdown
✅ 正确方法
❌ 错误方法
⚠️ 警告
💡 提示
📋 清单
🚩 危险信号
```

### 链接

始终使用仓库内的相对路径：

```markdown
[ADR-0001](../adr/ADR-0001-modular-monolith-vertical-slice-architecture.md)
[Prompt 库](../copilot/adr-0001.prompts.md)
```

## 图表

### Mermaid 图表

优先使用 mermaid：

- 架构图
- 流程图
- 序列图

### 何时使用图表

- 文字难以解释的复杂关系
- 架构概览
- 流程流
- 状态转换

### 何时不使用图表

- 简单的列表或层级（使用 markdown 列表）
- 单一关系（使用文字）
- 当图表会比文字解释更大时

## 文档维护

### 更新现有文档

1. **检查版本** - 更新版本号和日期
2. **维护结构** - 不要打破既定模式
3. **更新链接** - 确保所有引用仍然有效
4. **添加到历史** - 在版本历史部分记录更改

### 废弃文档

1. 将状态改为 `❌ 已废弃`
2. 添加废弃日期
3. 链接到替代文档
4. 解释为什么被废弃

### 交叉引用

始终维护双向链接：

### 更新索引文件

创建新文档时，必须更新相关的索引/目录文件：

#### 添加新的 Summary 文档

当在 `docs/summaries/` 中创建新的总结文档时：

1. 更新 `docs/summaries/README.md`
2. 添加引用：
3. 使用与现有文档一致的格式

#### 添加新的 ADR

1. 更新 `docs/adr/README.md`
2. 在相应的类别 README 中添加
3. 更新相关的 index.md 文件

#### 添加新的 Copilot Prompt

1. 更新 `docs/copilot/README.md`
2. 在文件列表中添加新文档
