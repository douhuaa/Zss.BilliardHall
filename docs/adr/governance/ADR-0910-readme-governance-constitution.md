# ADR-0910：README 编写与维护宪法

> ⚖️ **本 ADR 是所有 README 文档的唯一裁决源，定义 README 的边界、约束与执法机制。**

**状态**：✅ Final（治理层，不可随意修改）  
**级别**：治理层 / 架构元规则  
**适用范围**：所有 README 文档（仓库根目录、模块、工具、文档目录）  
**生效时间**：即刻  
**版本**：1.0  
**修订日期**：2026-01-25

---

## 聚焦内容（Focus）

- README 的定位与权限边界
- README 禁用的语言与表达
- README 必须包含的声明
- README 违规的自动化检测
- README 与 ADR 的关系

---

## 为什么需要 ADR-0910（Why This ADR Matters）

### 问题陈述

在 ADR-0910 之前：

- ❌ README 是违规高发区，经常误用裁决性语言
- ❌ README 试图定义架构规则而非解释使用方法
- ❌ 缺乏针对 README 的专门自动化检测
- ❌ README 违规埋没在通用文档治理中，不够显眼
- ❌ 开发者不清楚 README 的权限边界

### ADR-0910 的定位

ADR-0910 是：

- 📌 **README 违规的专门执法机制**
- 📌 **防止 README 成为隐性规则源的专项约束**
- 📌 **确保 README 仅作为使用说明的根本保障**
- 📌 **所有 README 编写的元规则（Meta-Rule）**

一句话定位：

> **README 是使用说明，不是架构裁决书。**

---

## 术语表（Glossary）

| 术语         | 定义                                              | 英文对照                      |
|------------|------------------------------------------------|---------------------------|
| README     | 说明性文档，解释"如何使用"，无架构裁决力                         | README Document           |
| 裁决性语言      | 定义规则、做出判断的词汇，如"必须"、"禁止"、"不允许"                | Decision Language         |
| 描述性语言      | 解释用法、提供步骤的词汇，如"可以"、"推荐"、"示例"                 | Descriptive Language      |
| 无裁决力声明     | README 必须在开头声明无架构裁决权                           | No-Authority Declaration  |
| README 越界  | README 试图定义架构规则或做出架构判断                         | README Boundary Violation |
| 引用式裁决      | 通过引用 ADR 来传达规则，而非 README 自身定义规则               | Reference-based Decision  |

---

## 核心决策（Decision）

### 决策 1：README 的定位（唯一裁决）

**规则本体**：

README **只允许**表达以下内容：

- ✅ 解释如何使用系统/模块/工具
- ✅ 提供快速开始指南
- ✅ 说明配置步骤
- ✅ 列举示例代码和命令
- ✅ 链接到 ADR 和其他权威文档
- ✅ 描述项目结构和目录说明

README **禁止**表达以下内容：

- ❌ 定义架构规则（如"模块必须隔离"）
- ❌ 做出架构判断（如"这个设计符合架构"）
- ❌ 使用裁决性语言（见决策 2）
- ❌ 替代 ADR 解释架构约束
- ❌ 引入新的术语定义（应在 ADR 中定义）

**核心原则**：

> **README 回答：怎么用、怎么做、示例是什么**  
> **README 不回答：是否允许、为什么、如何裁决**

---

### 决策 2：README 禁用的裁决性语言

**规则本体**：

README 中**禁止**使用以下裁决性词汇（除非在特定允许的上下文中）：

| 裁决性词汇 | 说明                  | 替代表达          |
|-------|---------------------|---------------|
| 必须    | 定义强制要求              | "根据 ADR-XXXX" |
| 禁止    | 定义不允许的行为            | "根据 ADR-XXXX" |
| 不允许   | 定义不允许的行为            | "根据 ADR-XXXX" |
| 不得    | 定义不允许的行为            | "根据 ADR-XXXX" |
| 应当    | 定义规范性要求             | "建议"、"推荐"     |
| 违规    | 做出合规性判断             | "不符合 ADR-XXXX" |
| 合规    | 做出合规性判断             | "符合 ADR-XXXX"  |
| 不符合   | 做出合规性判断             | "参考 ADR-XXXX"  |

**允许使用裁决性词汇的上下文**：

README 可以在以下情况使用裁决性词汇：

1. **引用 ADR**：明确指出规则来源于 ADR

```markdown
✅ "根据 ADR-0001，模块必须隔离"
✅ "详见 ADR-0005 关于 Handler 的规定"
✅ "参考 ADR-0003 的命名空间规则"
```

2. **示例标记**：在代码示例中用 ✅/❌ 标记正确/错误

```markdown
✅ 示例：
```csharp
// ✅ 正确：使用事件通信
// ❌ 错误：直接引用其他模块
```
```

3. **表格内容**：在对比表格中说明规则

```markdown
✅ 表格：
| 操作 | 是否允许 | 依据 |
|-----|---------|------|
| 跨模块引用 | 禁止 | ADR-0001 |
```

4. **引用块**：在引用块中转述 ADR

```markdown
✅ 引用块：
> 根据 ADR-0001：模块禁止直接引用其他模块
```

**检测规则**：

- ✅ CI 自动扫描 README 文档
- ✅ 发现裁决性词汇时，检查是否在允许的上下文中
- ✅ 不在允许上下文中的使用 = 架构违规

---

### 决策 3：README 必须包含的声明

**规则本体**：

所有 README 文档**必须**在显著位置（文档开头）包含"无裁决力声明"：

**强制格式**：

```markdown
⚠️ 本文档不具备裁决力。所有架构决策以对应 ADR 正文为准。
```

**位置要求**：

- ✅ **必须**在文档开头，标题之后的第一段
- ✅ **必须**在任何架构内容之前
- ✅ **必须**显著可见（使用 ⚠️ 警告符号）

**示例布局**：

```markdown
# 模块名称

⚠️ 本文档不具备裁决力。所有架构决策以对应 ADR 正文为准。

## 概述

[内容...]
```

**例外**：

以下 README 可以豁免此声明：

- ✅ 纯操作性 README（如工具脚本的 README，只有命令示例）
- ✅ 第三方库的 README（如 node_modules 中的）
- ✅ 自动生成的 README（如 dotnet new 生成的模板）

**检测规则**：

- ✅ CI 扫描所有自定义 README
- ✅ 检查是否包含"不具备裁决力"或"无裁决力"或"无架构裁决权"
- ✅ 缺失声明 = CI 阻断

---

### 决策 4：README 与 ADR 的关系

**规则本体**：

README 与 ADR 的关系**必须**遵循以下规则：

**唯一合法的引用方式**：

```markdown
✅ 正确：明确引用 ADR 源头
"根据 ADR-0008，文档分级如下：..."
"详见 ADR-0001 第 3.2 节关于模块隔离的规定"
"参考 ADR-0005 了解 Handler 模式"

❌ 错误：转述为 README 自己的命令
"文档必须遵循以下规则"
"模块应该使用事件通信"
"开发者需要遵守以下约束"
```

**核心原则**：

> **README 只能指向 ADR，不能转述为命令。**

1. **引用而非定义**

```markdown
❌ 错误：README 定义规则
"模块必须使用事件通信，禁止直接引用"

✅ 正确：README 引用 ADR
"根据 ADR-0001，模块使用事件通信。详见 [ADR-0001](docs/adr/constitutional/ADR-0001-modular-monolith-vertical-slice-architecture.md)"
```

2. **描述而非裁决**

```markdown
❌ 错误：README 做出判断
"这个设计不符合架构规范"

✅ 正确：README 描述用法
"示例：使用事件发布订阅模式进行模块通信（ADR-0001）"
```

3. **链接而非复制**

```markdown
❌ 错误：README 复制 ADR 内容
"ADR-0001 规定：模块禁止..."（长篇复制）

✅ 正确：README 链接到 ADR
"模块通信规则详见 [ADR-0001](链接)"
```

**强制检测规则**：

README 中出现以下模式**必须**有明确的 ADR 引用：

| 违规模式                    | 检测关键词              | 必须配对的引用模式         |
|-------------------------|--------------------|--------------------|
| "必须..." / "禁止..." / "不允许..." | 裁决性词汇              | "根据 ADR-XXXX"     |
| "架构要求..." / "规范要求..."       | 要求 + 架构/规范         | "根据 ADR-XXXX"     |
| "不符合..." / "违反..."          | 合规性判断              | "参考 ADR-XXXX"     |
| "模块应该..." / "Handler需要..."  | 带主语的规范性陈述          | "根据 ADR-XXXX"     |

**核心原则（再次强调）**：

> **README 是 ADR 的索引和指南，不是 ADR 的副本或替代品。**  
> **README 只能指向 ADR，不能转述为命令。**

---

### 决策 5：README 的变更治理

**规则本体**：

| README 类型    | 变更要求          | 审批流程        |
|--------------|---------------|-------------|
| 仓库根 README   | 若涉及架构概念，需回溯 ADR | Code Review |
| 模块 README    | 自由修改，但需保持声明   | Code Review |
| 工具/脚本 README | 自由修改          | Code Review |
| 文档目录 README  | 自由修改，但需保持声明   | Code Review |

**冲突裁决**：

当 README 与 ADR 冲突时：

- ✅ **必须**修正 README
- ✅ **不得**以"README 说了"为由违反 ADR
- ✅ **不得**以"README 更新"为由绕过 ADR 流程

**强制规则**：

若 README 的修改可能影响对 ADR 的理解，**必须**：

1. 首先评估是否需要修改 ADR 正文
2. 若需要，先提交 ADR 修订 PR
3. ADR 修订通过后，再同步更新 README
4. **禁止**仅更新 README 而不修订 ADR

---

## 执法模型（Enforcement）

### 测试映射

| 规则编号        | 执行级 | 测试 / 手段                                        |
|-------------|-----|------------------------------------------------|
| ADR-0910.1  | L2  | CI 脚本检查 README 是否使用裁决性语言                       |
| ADR-0910.2  | L2  | CI 脚本检查 README 是否包含"无裁决力声明"                   |
| ADR-0910.3  | L3  | Code Review 检查 README 是否越界                     |
| ADR-0910.4  | L2  | ArchitectureTests: README_Must_Not_Use_Decision_Language |
| ADR-0910.5  | L2  | ArchitectureTests: README_Must_Declare_No_Authority    |

### 自动化检查工具

**已实现**：

```csharp
// ADR_0910_Architecture_Tests.cs

[Fact(DisplayName = "ADR-0910.1: README 不得使用裁决性语言")]
public void README_Must_Not_Use_Decision_Language()

[Fact(DisplayName = "ADR-0910.2: README 必须声明无裁决力")]
public void README_Must_Declare_No_Authority()
```

**检查逻辑**：

1. **扫描所有 README 文件**
   - 仓库根目录 README.md
   - docs/ 下的所有 README.md
   - 模块中的 README.md
   - 工具/脚本中的 README.md

2. **检测裁决性语言**
   - 提取非代码块、非引用块的纯文本
   - 检查是否包含裁决性词汇
   - 验证是否在允许的上下文中使用

3. **检测无裁决力声明**
   - 检查文档开头是否包含声明
   - 验证声明格式是否符合要求

4. **报告违规**
   - 列出违规文件和行号
   - 给出修复建议
   - CI 阻断构建

---

## 破例与归还（Exception）

### 允许破例的前提

README 规则的破例**仅在以下情况允许**：

- 临时性迁移文档（需在标题标注 `[DRAFT]` 或 `[迁移中]`）
- 历史遗留 README 的过渡期（不超过 1 个月）
- 第三方生成的 README（如框架模板）

### 破例要求

每个破例**必须**：

- 记录在 `ARCH-VIOLATIONS.md` 的"README 治理破例"章节
- 指明破例的具体 README 文件和原因
- 指定失效日期（不超过 1 个月）
- 给出归还计划

**未记录的破例 = 未授权违规。**

---

## 变更政策（Change Policy）

### 变更规则

- **ADR-0910**（治理层）
  - 修改需 Tech Lead 审批
  - 需要全量 README 回归检查
  - 需要更新对应的架构测试

- **README 文档**
  - 可自由修改
  - 但若影响规则理解，需回溯 ADR 修订

### 失效与替代

- Superseded README 规则**必须**在新规则中明确指出
- 不允许"隐式废弃"

---

## 明确不管什么（Non-Goals）

本 ADR **不负责**：

- README 的写作风格和美学
- README 的长度限制
- README 的多语言版本
- README 的格式工具选择（Markdown、AsciiDoc 等）
- README 的内容完整性（如是否包含所有功能）

这些由项目团队自行决定。

---

## 非裁决性参考（References）

- ADR-0008：文档编写与维护宪法（README 从此 ADR 中独立出来）
- ADR-0000：架构测试与 CI 治理宪法
- ADR-0006：术语与编号宪法
- `docs/copilot/adr-0910.prompts.md`：场景化示例（待创建）
- `src/tests/ArchitectureTests/ADR/ADR_0910_Architecture_Tests.cs`：执行测试

---

## 核心原则总结

> **README 是使用说明，不是架构裁决书。**

- 📌 README 只解释"怎么用"，不定义"是否允许"
- 📌 README 引用 ADR，不替代 ADR
- 📌 README 必须声明无裁决力
- 📌 裁决性语言的使用受到严格限制和自动化检测
- 📌 违规的 README = CI 阻断，无例外

---

## 版本历史

| 版本  | 日期         | 变更说明                                      |
|-----|------------|-------------------------------------------|
| 1.2 | 2026-01-25 | 标准化决策 3 强制声明格式，推荐简洁版"⚠️ 本文档不具备裁决力..." |
| 1.1 | 2026-01-25 | 强化决策 4：明确"README 只能指向 ADR，不能转述为命令"      |
| 1.0 | 2026-01-25 | 初版，从 ADR-0008 中独立出 README 专用治理规则，增强自动化执法  |

---

**维护**：架构委员会  
**审核**：@douhuaa  
**状态**：✅ Final
