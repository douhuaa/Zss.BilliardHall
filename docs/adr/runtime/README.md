# 运行时行为层 ADR (ADR-200 ~ 299)

**编号范围**：ADR-200 ~ ADR-299  
**层级定位**：运行行为 / 交互协议 / 执行边界

---

## 定义

运行时行为层 ADR 定义系统的执行模型、模块协作、一致性保障等动态行为：

- **执行模型**：Use Case 如何被执行
- **通信协议**：模块间如何交互（同步/异步）
- **事务边界**：如何保障数据一致性
- **错误处理**：如何处理失败和异常
- **事件流转**：领域事件的发布和订阅

---

## 与宪法层的关系

运行时行为层是对宪法层执行模型的细化：

```
宪法层定义原则：
- ADR-0005：Handler 模式、CQRS、异步优先

↓ 细化

运行时层定义细节：
- ADR-2xx：Handler 生命周期管理
- ADR-2xx：事件版本化与兼容性
- ADR-2xx：错误处理与重试策略
- ADR-2xx：事务边界与补偿
```

---

## 编号规则

| 编号段         | 用途             |
|-------------|----------------|
| ADR-200~209 | Handler 执行模型细节 |
| ADR-210~219 | 模块间通信协议        |
| ADR-220~229 | 事件驱动架构细节       |
| ADR-230~239 | 事务与一致性策略       |
| ADR-240~249 | 错误处理与容错        |
| ADR-250~299 | 其他运行时主题        |

---

## 当前状态

### 已采纳的运行时行为 ADR

- **[ADR-240：Handler 异常约束](./ADR-240-handler-exception-constraints.md)** ✅
  - Handler 禁止抛出通用异常
  - 可重试标记仅限基础设施异常
  - Handler 禁止吞噬异常
  - 异常类型命名空间约束
  - 跨模块事件异常禁止同步传播

### 宪法层相关 ADR

- ADR-0005：应用内交互模型与执行边界
- ADR-0005-Enforcement-Levels：执行级别分类

---

## 待落地的 ADR（已规划）

> 详见 [待落地 ADR 提案跟踪清单](../PENDING-ADR-PROPOSALS.md)

### 高优先级
- **ADR-201**：Command Handler 生命周期管理（📋 Proposed）
  - Handler 生命周期规范、幂等性、资源释放标准
- **ADR-210**：领域事件版本化与兼容性（📋 Proposed）
  - 事件版本命名、序列化格式、向后兼容性、迁移适配

### 中优先级
- **ADR-220**：集成事件总线选型与适配规范（📋 Proposed）
  - 事件总线技术选型、发布/订阅接口、幂等性保障

### 未来可能的 ADR
- **ADR-202**：Query Handler 超时与降级策略
- **ADR-211**：模块间同步调用审批流程
- **ADR-230**：Saga 模式应用指南
- **ADR-241**：补偿事务设计指南

---

## 参考文档

- [ADR-0005：应用内交互模型与执行边界](../constitutional/ADR-0005-Application-Interaction-Model-Final.md)
- [ADR-0005：执行级别分类](../constitutional/ADR-0005-Enforcement-Levels.md)
