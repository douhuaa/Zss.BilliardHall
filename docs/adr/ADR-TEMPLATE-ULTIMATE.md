# ADR-XXXX：〈裁决型标题〉

**状态**：Draft | Accepted | Final | Superseded  
**级别**：宪法层 | 决策层  
**影响范围**：〈明确列出模块 / 层 / 仓库〉  
**生效时间**：YYYY-MM-DD

---

## 1. 规则本体（Rule）

> **这是本 ADR 唯一具有裁决力的部分。**

用**不可协商、可判真伪**的句子描述规则。

**必须满足：**

* 不依赖作者解释
* 不引用实现细节
* 不包含"建议 / 通常 / 尽量 / 可以"

**推荐格式：**

* ❗ 必须（MUST）/ 禁止（MUST NOT）/ 应当（SHALL）/ 不应（SHALL NOT）
* ❗ 违反即为架构违规

**示例：**

* Platform **禁止**依赖 Application 或 Host
* 模块**禁止**直接引用其他模块
* 所有标记【必须架构测试覆盖】的 ADR **必须**至少有一个架构测试

> 规则段落 **≤ 1 页**，超过就是设计说明，不是 ADR。

---

## 2. 执法模型（Enforcement）

> **规则如果无法执法，就不配存在。**

### 2.1 执行级别

| 级别 | 名称      | 执法方式               | 后果    |
| ---- | ------- | ------------------ | ----- |
| L1   | 静态可执行   | 自动化测试              | CI 阻断 |
| L2   | 语义半自动   | Analyzer / 启发式     | 人工复核  |
| L3   | 人工 Gate | Review / Checklist | 架构裁决  |

**每一条规则必须标注级别。**

---

### 2.2 测试映射（如适用）

> 仅列出**裁决级**测试，不列示例。

| 规则编号       | 执行级 | 测试 / 手段                        |
| ---------- | --- | ------------------------------ |
| ADR-XXXX.1 | L1  | `XXX_Should_Not_Depend_On_YYY` |
| ADR-XXXX.2 | L2  | Roslyn Analyzer / Review       |
| ADR-XXXX.3 | L3  | ARCH-GATE                      |

---

## 3. 破例与归还（Exception）

> **破例不是逃避，而是债务。**

### 3.1 允许破例的前提

破例 **仅在以下情况允许**：

* 技术限制
* 性能约束
* 迁移期遗留问题
* 外部系统强制约束

---

### 3.2 破例要求（不可省略）

每个破例 **必须**：

* 记录在 `ARCH-VIOLATIONS.md`
* 指明 ADR 编号 + 规则编号
* 指定失效日期
* 给出归还计划

**未记录的破例 = 未授权架构违规。**

---

## 4. 变更政策（Change Policy）

> **ADR 不是"随时可改"的文档。**

### 4.1 变更规则

* **宪法层 ADR**

  * 修改 = 架构修宪
  * 需要显式评审 + 全量回归测试

* **决策层 ADR**

  * 可 Superseded
  * 不得悄然修改规则

---

### 4.2 失效与替代

* Superseded ADR **必须**指向替代 ADR
* 不允许"隐性废弃"

---

## 5. 明确不管什么（Non-Goals）

> **防止 ADR 膨胀的关键段落。**

本 ADR **不负责**：

* 代码风格
* 命名美学
* 教学示例
* 实现细节
* 临时约定

---

## 6. 非裁决性参考（References）

> **仅供理解，不具裁决力。**

* 相关 ADR
* 规范文档
* 背景材料
* 历史讨论

---

# 附：ADR 写作红线（强制）

**出现以下任一项，说明你在写"说明文"，不是 ADR：**

* 长背景故事
* 方案对比表
* 大段 Why 论证
* 示例代码
* "建议 / 推荐 / 尽量"
* 读者假设（"为了帮助理解…"）

---

# ADR 终极一句话定义

> **ADR 是系统的法律条文，不是架构师的解释说明。**
