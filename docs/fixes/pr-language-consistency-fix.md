# PR 语言一致性修复文档

## 问题描述

Copilot 在智能体会话中生成 PR 描述时，开始时能遵循要求使用中文，但在任务完成时回复会变成英文。

## 根本原因

原有的 `.github/copilot-instructions.md` 文件中，中文语言要求仅在文档开头以简单的一行标题形式出现：

```markdown
## pr标题、描述和回复一律用中文
```

这种表述存在以下问题：
1. **位置不够显眼**：仅在文档开头提及一次
2. **强调不够**：没有明确说明适用于任务的整个生命周期
3. **缺少上下文提醒**：在关键执行阶段（如反馈报告、任务完成）没有重申

## 解决方案

### 1. 扩展语言使用规则章节（第5-20行）

将简单的一行标题改造为详细的章节，包括：
- **6项强制要求**：明确所有场景（PR标题、描述、回复、进度报告、FailureObject、任务各阶段）都必须使用中文
- **3项禁止行为**：明确禁止在任务完成、PR更新、反馈报告时使用英文
- **重要提醒**：强调规则适用于整个任务生命周期

### 2. 在关键章节添加语言要求提醒

#### FailureObject 章节（第114行）
```markdown
> ⚠️ **语言要求**：所有 FailureObject 字段内容必须使用中文。
```

#### 反馈与报告章节（第162行）
```markdown
> ⚠️ **语言要求**：所有反馈、报告、进度更新必须使用中文，包括任务完成时的最终回复。
```

### 3. 添加最终提醒章节（第229-241行）

在文档末尾添加醒目的"最终提醒"章节：
- 使用 🔴 红色标记突出关键规则
- 详细列出所有适用范围
- **特别强调**任务完成时的最终回复
- 明确指出切换为英文是不可接受的行为

## 预期效果

通过这些改进，Copilot Agent 在以下场景中都会收到明确的中文使用要求：
1. 读取配置文件开头时
2. 处理错误和生成 FailureObject 时
3. 准备反馈和报告时
4. 任务即将完成时（通过末尾的"最终提醒"）

这样可以确保 Agent 在整个任务生命周期中都能保持使用中文，避免在任务完成时切换为英文。

## 验证方法

在实际使用中观察：
1. PR 标题是否使用中文
2. PR 描述是否使用中文
3. 任务执行过程中的进度更新是否使用中文
4. **重点验证**：任务完成时的最终回复是否使用中文

## 相关文件

- `.github/copilot-instructions.md` - 主要修改文件
- 本文档：`docs/fixes/pr-language-consistency-fix.md`

## 修改日期

2026-02-04
