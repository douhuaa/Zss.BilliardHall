# 测试性能基线配置

本文件定义了测试性能的基线标准和阈值。

## 性能阈值

### 测试执行时间分类

| 分类 | 阈值 | 说明 |
|------|------|------|
| 🟢 快速 | < 100ms | 理想状态，单元测试和简单架构测试 |
| 🟡 正常 | 100-500ms | 可接受，复杂架构测试 |
| 🟠 慢 | 500-1000ms | 需要关注，考虑优化 |
| 🔴 非常慢 | > 1000ms | 需要优化，可能存在问题 |

### 测试套件总体性能目标

- **架构测试总执行时间**：< 5 秒
- **单元测试总执行时间**：< 10 秒
- **集成测试总执行时间**：< 30 秒

## 性能回归检测规则

如果测试执行时间相比基线增加超过以下阈值，应触发警告：

- **单个测试**：增加 > 50%
- **测试套件**：增加 > 20%

## 性能优化建议

当测试性能下降时，考虑以下优化措施：

1. **减少文件 I/O**
   - 使用缓存共享测试数据
   - 避免重复读取相同文件
   
2. **优化数据加载**
   - 使用 Fixture 共享数据
   - 使用 Lazy<T> 延迟加载
   
3. **并行执行**
   - 确保测试可以安全并行执行
   - 使用 xUnit 的 Collection 特性控制并行度
   
4. **减少反射操作**
   - 缓存反射结果
   - 使用编译期类型检查

## 基线更新策略

性能基线应在以下情况下更新：

1. **合理的性能提升**：通过优化提升了测试性能
2. **架构变更**：合理的架构变更导致性能变化
3. **测试覆盖增加**：新增测试用例

## 监控和报告

- **频率**：每次 PR 构建时运行
- **报告**：生成 Markdown 格式的性能报告
- **存储**：保存最近 30 天的性能数据
- **趋势**：每周生成性能趋势图

## 当前基线（2026-01-31）

> 注：首次运行时建立基线，后续可以通过实际运行结果更新

### 架构测试

- **测试总数**：~200
- **总执行时间**：~3 秒
- **平均执行时间**：~15ms
- **最慢测试**：< 500ms

### 预期性能改进（通过 FluentAssertions 和共享工具）

- **测试时间减少**：~20-30%
- **代码可读性**：提升
- **维护成本**：降低
